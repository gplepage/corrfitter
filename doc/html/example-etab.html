
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Annotated Example: Matrix Correlator &#8212; corrfitter 8.1.1 documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="corrfitter - Least-Squares Fit to Correlators" href="corrfitter.html" />
    <link rel="prev" title="Annotated Example: Transition Form Factor and Mixing" href="example-etas-Ds.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="corrfitter.html" title="corrfitter - Least-Squares Fit to Correlators"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="example-etas-Ds.html" title="Annotated Example: Transition Form Factor and Mixing"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">corrfitter 8.1.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="annotated-example-matrix-correlator">
<h1>Annotated Example: Matrix Correlator<a class="headerlink" href="#annotated-example-matrix-correlator" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Matrix correlators, built  from multiple sources and sinks,
greatly improve results for the excited states in the correlators.
Here we analyze <img class="math" src="_images/math/796bef5908cc057118322358f951a56a1bc1ae36.svg" alt="\eta_b"/> correlators using 4 sources/sinks using
a prior designed by <a class="reference internal" href="corrfitter.html#corrfitter.EigenBasis" title="corrfitter.EigenBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.EigenBasis</span></code></a>.</p>
<p>A major challenge when studying excited states with multi-source
fits is the appearance in the fit of spurious states, with amplitudes that
are essentially zero, between the real states in the correlator.
These states contribute little to the correlators, because of their
vanishing amplitudes, but they usually have a strong negative impact
on the errors of states just below them and above them. They also can cause
the fitter to stall, taking 1000s of iterations to change nothing other
than the parameters of the spurious state.
<a class="reference internal" href="corrfitter.html#corrfitter.EigenBasis" title="corrfitter.EigenBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.EigenBasis</span></code></a> addresses this problem by creating a prior that discourages
spurious states. It encodes the fact that only a small number of states
still couple to the matrix correlator by moderate values of <code class="docutils literal notranslate"><span class="pre">t</span></code>, and
therefore, that there exist linear combinations of the sources that
couple strongly to individual low-lying states but not the others. This
leaves little room for spurious low-lying states.</p>
<p>This example involves only two-point correlators. Priors generated
by <a class="reference internal" href="corrfitter.html#corrfitter.EigenBasis" title="corrfitter.EigenBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.EigenBasis</span></code></a> are also useful in fits to three-point correlators,
with multiple eigen-bases if different types of hadron are involved.</p>
<p>The source code (<code class="docutils literal notranslate"><span class="pre">etab.py</span></code>) and data file
(<code class="docutils literal notranslate"><span class="pre">etab.data</span></code>) are included with the <a class="reference internal" href="corrfitter.html#module-corrfitter" title="corrfitter: Least-Squares Fit to Correlators."><code class="xref py py-mod docutils literal notranslate"><span class="pre">corrfitter</span></code></a> distribution,
in the <code class="docutils literal notranslate"><span class="pre">examples/</span></code> directory.
The data are from the HPQCD collaboration.</p>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>The main method follows the template in <a class="reference internal" href="overview.html#basic-fits"><span class="std std-ref">Basic Fits</span></a>, but
modified to handle the <a class="reference internal" href="corrfitter.html#corrfitter.EigenBasis" title="corrfitter.EigenBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.EigenBasis</span></code></a> object <code class="docutils literal notranslate"><span class="pre">basis</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>   <span class="c1"># makes this work for python2 and 3</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">gvar</span> <span class="k">as</span> <span class="nn">gv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">corrfitter</span> <span class="k">as</span> <span class="nn">cf</span>

<span class="n">SHOWPLOTS</span> <span class="o">=</span> <span class="kc">False</span>         <span class="c1"># display plots at end of fits?</span>

<span class="n">SOURCES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
<span class="n">KEYFMT</span> <span class="o">=</span> <span class="s1">&#39;1s0.</span><span class="si">{s1}{s2}</span><span class="s1">&#39;</span>
<span class="n">TDATA</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">SVDCUT</span> <span class="o">=</span> <span class="mf">0.007</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="s1">&#39;etab.h5&#39;</span><span class="p">)</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CorrFitter</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">make_models</span><span class="p">())</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;nterm =&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="s1">&#39;v&#39;</span><span class="p">))</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pmean</span>
    <span class="n">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">SHOWPLOTS</span><span class="p">:</span>
        <span class="n">fit</span><span class="o">.</span><span class="n">show_plots</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The eigen-basis is created by <code class="docutils literal notranslate"><span class="pre">make_data('etab.h5')</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">fit</span><span class="o">.</span><span class="n">qqplot_residuals</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">make_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">avg_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">grep</span><span class="o">=</span><span class="s1">&#39;1s0&#39;</span><span class="p">))</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">EigenBasis</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="n">KEYFMT</span><span class="p">,</span> <span class="n">srcs</span><span class="o">=</span><span class="n">SOURCES</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">tdata</span><span class="o">=</span><span class="n">TDATA</span><span class="p">,</span>
</pre></div>
</div>
<p>It reads Monte Carlo
data from file <code class="docutils literal notranslate"><span class="pre">'etab.h5'</span></code>, which is an hdf5-format file that
contains 16 hdf5 datasets of interest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;etab.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.dd&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.de&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.dg&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.dl&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.ed&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.ee&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.eg&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.el&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.gd&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.ge&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.gg&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.gl&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.ld&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.le&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.lg&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;1s0.ll&quot;: shape (113, 23), type &quot;&lt;f8&quot;&gt;</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Each of these contains 113 Monte Carlo samples for a
different correlator evaluated at times <code class="docutils literal notranslate"><span class="pre">t=1,2...23</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;1s0.ll&#39;</span><span class="p">][:,</span> <span class="p">:])</span>
<span class="go">[[ 0.360641  0.202182  0.134458 ...,  0.00118724  0.00091401  0.00070451]</span>
<span class="go"> [ 0.365291  0.210573  0.143632 ...,  0.00133125  0.0010258   0.00078879]</span>
<span class="go"> [ 0.362848  0.210732  0.143037 ...,  0.00130843  0.00101     0.00077627]</span>
<span class="go"> ...,</span>
<span class="go"> [ 0.364053  0.209284  0.141544 ...,  0.00120762  0.00093206  0.0007196 ]</span>
<span class="go"> [ 0.365236  0.209835  0.139057 ...,  0.00116917  0.00089636  0.00069045]</span>
<span class="go"> [ 0.362479  0.20709   0.136687 ...,  0.00106393  0.0008269   0.00064707]]</span>
</pre></div>
</div>
<p>The sixteen different correlators have tags given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KEYFMT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">KEYFMT='1s0.{s1}{s2}'</span></code>, and <code class="docutils literal notranslate"><span class="pre">s1</span></code> and <code class="docutils literal notranslate"><span class="pre">s2</span></code> are
drawn from the list
<code class="docutils literal notranslate"><span class="pre">SOURCES=['l',</span> <span class="pre">'g',</span> <span class="pre">'d',</span> <span class="pre">'e']</span></code>, which labels the sources and sinks used
to create the correlators.</p>
<p>The data are read in, and their means and covariance matrix computed
using <code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.dataset.avg_data()</span></code>. <a class="reference internal" href="corrfitter.html#corrfitter.EigenBasis" title="corrfitter.EigenBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.EigenBasis</span></code></a> then creates an
eigen-basis by solving a generalized eigenvalue problem involving the
matrices of correlators at <code class="docutils literal notranslate"><span class="pre">t=1</span></code> and <code class="docutils literal notranslate"><span class="pre">t=2</span></code>. (One might want
larger <code class="docutils literal notranslate"><span class="pre">t</span></code> values generally, but these data are too noisy.)
The eigenanalysis constructs a set of eigen-sources
that are linear combinations of the original sources chosen
so that each eigen-source overlaps strongly with one of the
lowest four states in the correlator, and weakly with all the others.
This eigen-basis is used later to construct the prior.</p>
<p>A correlator fitter, called <code class="docutils literal notranslate"><span class="pre">fitter</span></code>, is created from the list of correlator
models returned by <code class="docutils literal notranslate"><span class="pre">make_models()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">basis</span>

<span class="k">def</span> <span class="nf">make_models</span><span class="p">():</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">SOURCES</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="n">SOURCES</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
            <span class="n">tfit</span> <span class="o">=</span> <span class="n">TDATA</span> <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span> <span class="k">else</span> <span class="n">TDATA</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span>
            <span class="n">otherdata</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span> <span class="k">else</span> <span class="n">KEYFMT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s1</span><span class="p">)</span>
            <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">cf</span><span class="o">.</span><span class="n">Corr2</span><span class="p">(</span>
                    <span class="n">datatag</span><span class="o">=</span><span class="n">KEYFMT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">),</span>
                    <span class="n">tdata</span><span class="o">=</span><span class="n">TDATA</span><span class="p">,</span> <span class="n">tfit</span><span class="o">=</span><span class="n">tfit</span><span class="p">,</span>
                    <span class="n">a</span><span class="o">=</span><span class="s1">&#39;etab.&#39;</span> <span class="o">+</span> <span class="n">s1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s1">&#39;etab.&#39;</span> <span class="o">+</span> <span class="n">s2</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">,</span>
                    <span class="n">otherdata</span><span class="o">=</span><span class="n">otherdata</span><span class="p">,</span>
                    <span class="p">)</span>
</pre></div>
</div>
<p>There is one model for each correlator to be fit, so 16 in all. The keys
(<code class="docutils literal notranslate"><span class="pre">datatag</span></code>) for the correlator data are constructed from information
stored in the <code class="docutils literal notranslate"><span class="pre">basis</span></code>. Each correlator
has data (<code class="docutils literal notranslate"><span class="pre">tdata</span></code>) for <code class="docutils literal notranslate"><span class="pre">t=1...23</span></code>.
We fit all <code class="docutils literal notranslate"><span class="pre">t</span></code> values (<code class="docutils literal notranslate"><span class="pre">tfit</span></code>) for the diagonal elements of the
matrix correlator, but only about half the <code class="docutils literal notranslate"><span class="pre">t</span></code> values for other
correlators — the information at large <code class="docutils literal notranslate"><span class="pre">t</span></code> is highly correlated between
different correlators, and therefore somewhat redundant. The
amplitudes are labeled by <code class="docutils literal notranslate"><span class="pre">'etab.l'</span></code>, <code class="docutils literal notranslate"><span class="pre">'etab.g'</span></code>, <code class="docutils literal notranslate"><span class="pre">'etab.d'</span></code>, and
<code class="docutils literal notranslate"><span class="pre">'etab.e'</span></code> in the prior. The energy differences are labeled by <code class="docutils literal notranslate"><span class="pre">'etab.dE'</span></code>.</p>
<p>We try fits with <code class="docutils literal notranslate"><span class="pre">N=1,2..7</span></code> terms in the fit function.  The number of
terms is encoded in the prior, which is constructed by
<code class="docutils literal notranslate"><span class="pre">make_prior(N,</span> <span class="pre">basis)</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">return</span> <span class="n">models</span>

</pre></div>
</div>
<p>The prior looks complicated</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span>            <span class="n">prior</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="o">------------</span> <span class="o">---------------------------------------------------------------</span>
<span class="n">etab</span><span class="o">.</span><span class="n">l</span>       <span class="p">[</span><span class="o">-</span><span class="mf">0.51</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.45</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>   <span class="mf">0.50</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span>   <span class="mf">0.108</span><span class="p">(</span><span class="mi">94</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.06</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="o">...</span><span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="n">g</span>       <span class="p">[</span><span class="o">-</span><span class="mf">0.88</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span>   <span class="mf">0.104</span><span class="p">(</span><span class="mi">97</span><span class="p">),</span>  <span class="mf">0.051</span><span class="p">(</span><span class="mi">92</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.004</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.13</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="o">...</span><span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="n">d</span>       <span class="p">[</span><span class="o">-</span><span class="mf">0.243</span><span class="p">(</span><span class="mi">86</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.50</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.268</span><span class="p">(</span><span class="mi">91</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.161</span><span class="p">(</span><span class="mi">71</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.21</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">...</span><span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="n">e</span>       <span class="p">[</span><span class="o">-</span><span class="mf">0.211</span><span class="p">(</span><span class="mi">83</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.42</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.30</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="mf">0.26</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.12</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="o">...</span><span class="p">]</span>

<span class="n">log</span><span class="p">(</span><span class="n">etab</span><span class="o">.</span><span class="n">dE</span><span class="p">)</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.3</span><span class="p">(</span><span class="mf">2.3</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.5</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.5</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.5</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">-</span><span class="mf">0.5</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>but its underlying structure becomes clear if we project it unto the
eigen-basis using <code class="docutils literal notranslate"><span class="pre">prior_eig</span> <span class="pre">=</span> <span class="pre">basis.apply(prior,</span> <span class="pre">keyfmt='etab.{s1}')</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span>         <span class="n">prior_eig</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="o">------</span>    <span class="o">------------------------------------------------------------</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">0</span>    <span class="p">[</span><span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>    <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">etag</span><span class="o">.</span><span class="mi">1</span>    <span class="p">[</span> <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">2</span>    <span class="p">[</span> <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>    <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">3</span>    <span class="p">[</span> <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>    <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>   <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
</pre></div>
</div>
<p>The <em>a priori</em> expectation built into <code class="docutils literal notranslate"><span class="pre">prior_eig</span></code> (and therefore <code class="docutils literal notranslate"><span class="pre">prior</span></code>) is
that the ground state  overlaps strongly with the first source in the
eigen-basis, and weakly  with the other three. Similarly the first excited state
overlaps strongly with the second eigen-source, but none of the others. And so
on. The fifth  and higher excited states can overlap with every eigen-source.
The priors for the energy differences between successive levels are based
upon the energies obtained from the eigenanalysis (<code class="docutils literal notranslate"><span class="pre">basis.E</span></code>): the <code class="docutils literal notranslate"><span class="pre">dE</span></code>
prior for the ground state is taken to be <code class="docutils literal notranslate"><span class="pre">E0(E0)</span></code>, where <code class="docutils literal notranslate"><span class="pre">E0=basis.E[0]</span></code>,
while for the other states it equals <code class="docutils literal notranslate"><span class="pre">dE1(dE1)</span></code>,  where
<code class="docutils literal notranslate"><span class="pre">dE1=basis.E[1]-basis.E[0]</span></code>. The prior specifies log-normal  statistics for
<code class="docutils literal notranslate"><span class="pre">etab.dE</span></code> and so replaces it by <code class="docutils literal notranslate"><span class="pre">log(etab.dE)</span></code>.</p>
<p>The fit is done by <code class="docutils literal notranslate"><span class="pre">fitter.lsqfit(...)</span></code>. An SVD cut is needed
(<code class="docutils literal notranslate"><span class="pre">SVDCUT=0.007</span></code>) because the data are
heavily binned (to reduce the size of the  <a class="reference internal" href="corrfitter.html#module-corrfitter" title="corrfitter: Least-Squares Fit to Correlators."><code class="xref py py-mod docutils literal notranslate"><span class="pre">corrfitter</span></code></a> distribution).
The binning means there are too few random samples for
each data point to provide a good estimate of the data’s correlation
matrix without an SVD cut.
See <a class="reference internal" href="faster.html#svd-cuts"><span class="std std-ref">Accurate Fits — SVD Cuts</span></a> and the discussion below for more information.</p>
<p>Final results are printed out by <code class="docutils literal notranslate"><span class="pre">print_results(...)</span></code>
after the last fit is finished:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">return</span> <span class="n">basis</span><span class="o">.</span><span class="n">make_prior</span><span class="p">(</span><span class="n">nterm</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;Results</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">eig_srcs</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">])</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;a*E(2s-1s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;a*E(3s-1s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;E(3s-1s)/E(2s-1s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;prior&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;svdcut&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">correction</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">fmt_values</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">fmt_errorbudget</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">colwidth</span><span class="o">=</span><span class="mi">18</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prior:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;etab.l&#39;</span><span class="p">,</span> <span class="s1">&#39;etab.g&#39;</span><span class="p">,</span> <span class="s1">&#39;etab.d&#39;</span><span class="p">,</span> <span class="s1">&#39;etab.e&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{:13}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">prior</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="n">prior_eig</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;etab.0&#39;</span><span class="p">,</span> <span class="s1">&#39;etab.1&#39;</span><span class="p">,</span> <span class="s1">&#39;etab.2&#39;</span><span class="p">,</span> <span class="s1">&#39;etab.3&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span>
</pre></div>
</div>
<p>This method first writes out two tables listing energies and amplitudes for
the first 4 states in the correlator. The first table shows results for the
original sources, while the second is for the eigen-sources. The correlators
are from NRQCD so only energy differences are physical. The energy differences
for each of the first two excited states relative to the ground states are
stored in dictionary <code class="docutils literal notranslate"><span class="pre">outputs</span></code>. These are in lattice units. <code class="docutils literal notranslate"><span class="pre">outputs</span></code>
also contains the ratio of 3s-1s difference to the 2s-1s difference,
and here the lattice spacing cancels out.  The code automatically handles
statistical correlations between different energies as it does the arithmetic
for <code class="docutils literal notranslate"><span class="pre">outputs</span></code> — the fit results are all <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s. The <code class="docutils literal notranslate"><span class="pre">outputs</span></code>
are tabulated using <code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.fmt_values()</span></code>. An error budget is also
produced, using <code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.fmt_errorbudget()</span></code>, showing how much error
for each quantity comes from uncertainties in the prior and data, and
from uncertainties introduced by the SVD cut.</p>
<p>Finally plots showing the data divided by the fit for each correlator are
displayed (optionally).</p>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>Running the code produces the  following output for the last fit (<code class="docutils literal notranslate"><span class="pre">N=7</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.32</span> <span class="p">[</span><span class="mi">164</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1277.1</span>

<span class="n">Parameters</span><span class="p">:</span>
       <span class="n">etab</span><span class="o">.</span><span class="n">l</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.50617</span> <span class="p">(</span><span class="mi">88</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.51</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.397</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.45</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.414</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.50</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="mf">0.148</span> <span class="p">(</span><span class="mi">73</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.108</span> <span class="p">(</span><span class="mi">94</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.42</span> <span class="p">(</span><span class="mi">26</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.40</span> <span class="p">(</span><span class="mi">33</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.11</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etab</span><span class="o">.</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">1.3620</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">1.3</span> <span class="p">(</span><span class="mf">2.3</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.633</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>     <span class="o">-</span><span class="mf">1.084</span> <span class="p">(</span><span class="mi">95</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.56</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">1.01</span> <span class="p">(</span><span class="mi">69</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.56</span> <span class="p">(</span><span class="mi">95</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.60</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="n">g</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">0.8707</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.88</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="mf">0.1424</span> <span class="p">(</span><span class="mi">80</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.104</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.058</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.051</span> <span class="p">(</span><span class="mi">92</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="mf">0.033</span> <span class="p">(</span><span class="mi">49</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.004</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.31</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="n">d</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.21618</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.243</span> <span class="p">(</span><span class="mi">86</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.416</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.50</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>     <span class="o">-</span><span class="mf">0.246</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.268</span> <span class="p">(</span><span class="mi">91</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>     <span class="o">-</span><span class="mf">0.113</span> <span class="p">(</span><span class="mi">51</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.161</span> <span class="p">(</span><span class="mi">71</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.25</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.03</span> <span class="p">(</span><span class="mi">33</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.32</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="n">e</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.19707</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.211</span> <span class="p">(</span><span class="mi">83</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.349</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.42</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>     <span class="o">-</span><span class="mf">0.285</span> <span class="p">(</span><span class="mi">26</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.30</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="mf">0.261</span> <span class="p">(</span><span class="mi">59</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.26</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.19</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.09</span> <span class="p">(</span><span class="mi">34</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.37</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">----------------------------------------------------</span>
      <span class="n">etab</span><span class="o">.</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">0.25616</span> <span class="p">(</span><span class="mi">28</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.27</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.531</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.338</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.57</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.36</span> <span class="p">(</span><span class="mi">25</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.57</span> <span class="p">(</span><span class="mi">54</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.55</span> <span class="p">(</span><span class="mi">54</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">0.007</span><span class="o">/</span><span class="mi">130</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">82</span><span class="o">/</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<p>The <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> per degree of freedom is unusually small because of the
large SVD cut (see below). This fit required 169 iterations,
but took only a couple of seconds
on a laptop. The results are almost identical to those from <code class="docutils literal notranslate"><span class="pre">N=6</span></code> and <code class="docutils literal notranslate"><span class="pre">N=8</span></code>.</p>
<p>The final energies and amplitudes for the original sources are listed as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">E</span>            <span class="n">l</span>            <span class="n">g</span>           <span class="n">d</span>            <span class="n">e</span>          
    <span class="o">=================================================================</span>
     <span class="mi">0</span> <span class="mf">0.25616</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.50617</span><span class="p">(</span><span class="mi">88</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.8707</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.21618</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.19707</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
     <span class="mi">1</span> <span class="mf">0.787</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.397</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>    <span class="mf">0.1424</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.416</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.349</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  
     <span class="mi">2</span> <span class="mf">1.126</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>    <span class="mf">0.414</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>    <span class="mf">0.058</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.246</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.285</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>  
     <span class="mi">3</span> <span class="mf">1.70</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>     <span class="mf">0.148</span><span class="p">(</span><span class="mi">73</span><span class="p">)</span>    <span class="mf">0.033</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.113</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span>    <span class="mf">0.261</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>  
</pre></div>
</div>
<p>while for the eigen-sources they are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">E</span>            <span class="mi">0</span>           <span class="mi">1</span>           <span class="mi">2</span>            <span class="mi">3</span>          
    <span class="o">================================================================</span>
     <span class="mi">0</span> <span class="mf">0.25616</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>  <span class="mf">0.9817</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="mf">0.0068</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.00168</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>  <span class="mf">0.00156</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
     <span class="mi">1</span> <span class="mf">0.787</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.0339</span><span class="p">(</span><span class="mi">81</span><span class="p">)</span>  <span class="mf">0.890</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.022</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>    <span class="mf">0.0094</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span> 
     <span class="mi">2</span> <span class="mf">1.126</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>    <span class="mf">0.016</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>   <span class="mf">0.068</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span>   <span class="mf">0.863</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.003</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>  
     <span class="mi">3</span> <span class="mf">1.70</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>    <span class="o">-</span><span class="mf">0.020</span><span class="p">(</span><span class="mi">58</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.023</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>   <span class="mf">0.036</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span>    <span class="mf">0.899</span><span class="p">(</span><span class="mi">88</span><span class="p">)</span>  
</pre></div>
</div>
<p>The latter shows that the eigen-sources align quite well with the first
four states, as hoped. The errors, especially for the first three states,
are much smaller than the prior errors, which indicates strong signals for
these states.</p>
<p>Finally values and an error budget are presented for the 2s-1s and
3s-1s energy differences (in lattice units) and the ratio of the two:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Values</span><span class="p">:</span>
         <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">0.531</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>           
         <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">0.870</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>           
  <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">1.637</span><span class="p">(</span><span class="mi">62</span><span class="p">)</span>           

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                            <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span>        <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span>
<span class="o">--------------------------------------------------------------------------</span>
              <span class="n">prior</span><span class="p">:</span>              <span class="mf">0.72</span>              <span class="mf">2.23</span>              <span class="mf">2.08</span>
               <span class="n">data</span><span class="p">:</span>              <span class="mf">1.37</span>              <span class="mf">2.20</span>              <span class="mf">1.93</span>
             <span class="n">svdcut</span><span class="p">:</span>              <span class="mf">1.31</span>              <span class="mf">2.28</span>              <span class="mf">2.50</span>
<span class="o">--------------------------------------------------------------------------</span>
              <span class="n">total</span><span class="p">:</span>              <span class="mf">2.03</span>              <span class="mf">3.87</span>              <span class="mf">3.78</span>
</pre></div>
</div>
<p>The first excited state is obviously more accurately determined than
the second state, but the fit improves our knowledge of both.
The energies for the fifth and higher states merely echo the
<em>a priori</em> information in the prior — the data are not sufficiently
accurate to add much new information to what was in the prior. The prior
is less important for the three quantities tabulated here. The dominant
source of error in each case comes from either the SVD cut or the statistical
errors in the data.</p>
<p>Summary plots showing the data divided by the fit as a function of <code class="docutils literal notranslate"><span class="pre">t</span></code>
for each of the 16 correlators is shown below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><img alt="_images/etab.1s0.ll.png" src="_images/etab.1s0.ll.png" />
</td>
<td><img alt="_images/etab.1s0.lg.png" src="_images/etab.1s0.lg.png" />
</td>
<td><img alt="_images/etab.1s0.ld.png" src="_images/etab.1s0.ld.png" />
</td>
<td><img alt="_images/etab.1s0.le.png" src="_images/etab.1s0.le.png" />
</td>
</tr>
<tr class="row-odd"><td><img alt="_images/etab.1s0.gl.png" src="_images/etab.1s0.gl.png" />
</td>
<td><img alt="_images/etab.1s0.gg.png" src="_images/etab.1s0.gg.png" />
</td>
<td><img alt="_images/etab.1s0.gd.png" src="_images/etab.1s0.gd.png" />
</td>
<td><img alt="_images/etab.1s0.ge.png" src="_images/etab.1s0.ge.png" />
</td>
</tr>
<tr class="row-even"><td><img alt="_images/etab.1s0.dl.png" src="_images/etab.1s0.dl.png" />
</td>
<td><img alt="_images/etab.1s0.dg.png" src="_images/etab.1s0.dg.png" />
</td>
<td><img alt="_images/etab.1s0.dd.png" src="_images/etab.1s0.dd.png" />
</td>
<td><img alt="_images/etab.1s0.de.png" src="_images/etab.1s0.de.png" />
</td>
</tr>
<tr class="row-odd"><td><img alt="_images/etab.1s0.el.png" src="_images/etab.1s0.el.png" />
</td>
<td><img alt="_images/etab.1s0.eg.png" src="_images/etab.1s0.eg.png" />
</td>
<td><img alt="_images/etab.1s0.ed.png" src="_images/etab.1s0.ed.png" />
</td>
<td><img alt="_images/etab.1s0.ee.png" src="_images/etab.1s0.ee.png" />
</td>
</tr>
</tbody>
</table>
<p>These plots are displayed by the code above if flag
<code class="docutils literal notranslate"><span class="pre">DISPLAYPLOTS</span> <span class="pre">=</span> <span class="pre">True</span></code> is set at the beginning of the code. The points with
error bars are correlator data points; the fit result is 1.0 in these
plots; and the dashed lines show the uncertainty in the fit function
values for the best-fit parameters. Fit and data agree well for
all correlators and all <code class="docutils literal notranslate"><span class="pre">t</span></code> values. As expected, strong correlations
exist between points with near-by <code class="docutils literal notranslate"><span class="pre">t</span></code>s.</p>
</div>
<div class="section" id="setting-the-svd-cut">
<h2>Setting the SVD Cut<a class="headerlink" href="#setting-the-svd-cut" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, an SVD cut (<code class="docutils literal notranslate"><span class="pre">SVDCUT=0.007</span></code>)
was needed for this fit because there
are too few random samples of the correlators. The problem is that
the smallest eigenvalues of the data’s correlation matrix
are then underestimated, making the correlation matrix
too singular for use in the fit (see
<a class="reference internal" href="faster.html#svd-cuts"><span class="std std-ref">Accurate Fits — SVD Cuts</span></a>). The SVD cut adds extra uncertainty to the fit data
to correct for these eigenvalues, making the correlation matrix usable.</p>
<p>The value of the SVD cut was determined
using a short script that combines</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gvar</span> <span class="k">as</span> <span class="nn">gv</span>
<span class="kn">import</span> <span class="nn">corrfitter</span> <span class="k">as</span> <span class="nn">cf</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="s1">&#39;etab.h5&#39;</span><span class="p">,</span> <span class="n">grep</span><span class="o">=</span><span class="s1">&#39;1s0&#39;</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">svd_diagnosis</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="n">make_models</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;svdcut =&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">svdcut</span><span class="p">)</span>
</pre></div>
</div>
<p>with the code for <code class="docutils literal notranslate"><span class="pre">make_models()</span></code> described above.
Here <code class="docutils literal notranslate"><span class="pre">gv.dataset.svd_diagnosis(...)</span></code> compares the exact eigenvalues of the
correlation matrix with bootstrap estimates of the eigenvalues. The ratio of
bootstrap estimates to exact values is shown in the plot (from
<code class="docutils literal notranslate"><span class="pre">s.plot_ratio(show=True)</span></code>):</p>
<a class="reference internal image-reference" href="_images/etab-svdcut.png"><img alt="_images/etab-svdcut.png" src="_images/etab-svdcut.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>This shows that the SVD cut should be around 0.007, which is where the
ratio falls below one.</p>
<p>This is a relatively large SVD cut affecting many of the correlation
matrice’s eigenmodes (233 out of 260). As a result the fit’s <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/>
is quite small. As discussed in <a class="reference internal" href="faster.html#goodness-of-fit"><span class="std std-ref">Goodness of Fit</span></a>, we need to add
extra noise to the data if we want to use <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> to evaluate fit quality.
Adding the following code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># check fit quality by adding noise</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">==================== add svd, prior noise&#39;</span><span class="p">)</span>
    <span class="n">noisy_fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">pmean</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">,</span>
        <span class="n">noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">noisy_fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">dE</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">noisy_dE</span> <span class="o">=</span> <span class="n">noisy_fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      dE:&#39;</span><span class="p">,</span> <span class="n">dE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;noisy dE:&#39;</span><span class="p">,</span> <span class="n">noisy_dE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;          &#39;</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">fmt_chi2</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">dE</span> <span class="o">-</span> <span class="n">noisy_dE</span><span class="p">)))</span>
</pre></div>
</div>
<p>to the end of the <code class="docutils literal notranslate"><span class="pre">main()</span></code> method results in a second fit with noise
associated with both the SVD cut and the prior. The result is a good fit,
even with the additional noise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================</span> <span class="n">add</span> <span class="n">svd</span><span class="p">,</span> <span class="n">prior</span> <span class="n">noise</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">[</span><span class="mi">164</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.34</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1221.6</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">0.007</span><span class="o">/</span><span class="mi">130</span><span class="o">*</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">91</span><span class="o">/</span><span class="mf">0.7</span><span class="p">)</span>

      <span class="n">dE</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25616</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="mf">0.531</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="mf">0.338</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
<span class="n">noisy</span> <span class="n">dE</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25617</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="mf">0.5415</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="mf">0.345</span><span class="p">(</span><span class="mi">31</span><span class="p">)]</span>
           <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="o">=</span> <span class="mf">0.38</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.77</span>
</pre></div>
</div>
</div>
<div class="section" id="fit-stability">
<h2>Fit Stability<a class="headerlink" href="#fit-stability" title="Permalink to this headline">¶</a></h2>
<p>It is a good idea in fits like this one to test the stability of the
results to significant changes in the prior. This is especially true for
quantities like the 3s-1s splitting that involve more highly excited
states. The default prior in effect assigns each of the four sources in the
new basis to one of the four states in the correlator with the lowest
energies. Typically the actual correspondence between source and low-energy
state weakens as the energy increases. So an obvious test is to rerun the
fit but with a prior that associates states with only three of the sources,
leaving the fourth source unconstrained. This is done by replacing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">return</span> <span class="n">models</span>

</pre></div>
</div>
<p>with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">basis</span><span class="o">.</span><span class="n">make_prior</span><span class="p">(</span><span class="n">nterm</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>in the code. The <code class="docutils literal notranslate"><span class="pre">states</span></code> option in the second <code class="docutils literal notranslate"><span class="pre">basis.make_prior(...)</span></code>
assigns the three lowest lying states (in order of increasing energy)
to the first three eigen-sources, but leaves the fourth and higher states
unassigned. The prior for the amplitudes projected onto the eigen-basis
then becomes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span>         <span class="n">prior_eig</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="o">------</span>    <span class="o">----------------------------------------------------------</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">0</span>    <span class="p">[</span><span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>    <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">1</span>    <span class="p">[</span> <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>   <span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>   <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">2</span>    <span class="p">[</span> <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>    <span class="o">.</span><span class="mi">03</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="mf">1.00</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">etab</span><span class="o">.</span><span class="mi">3</span>    <span class="p">[</span> <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>    <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>   <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>  <span class="o">.</span><span class="mi">2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">...</span> <span class="p">]</span>
</pre></div>
</div>
<p>where now no strong assumption is made about the overlaps of the first three
eigen-sources with the fourth state, or about the overlap of the fourth source
with any state. Running with this (more conservative) prior gives
the following results for the last fit and summary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.32</span> <span class="p">[</span><span class="mi">164</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1270.3</span>

<span class="n">Parameters</span><span class="p">:</span>
       <span class="n">etab</span><span class="o">.</span><span class="n">l</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.50587</span> <span class="p">(</span><span class="mi">94</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.51</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.395</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.45</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.417</span> <span class="p">(</span><span class="mi">44</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.50</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.18</span> <span class="p">(</span><span class="mi">28</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.16</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.55</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.08</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etab</span><span class="o">.</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">1.3621</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">1.3</span> <span class="p">(</span><span class="mf">2.3</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.632</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">1.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.85</span> <span class="p">(</span><span class="mi">66</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">1.02</span> <span class="p">(</span><span class="mi">71</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.67</span> <span class="p">(</span><span class="mi">85</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.61</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="n">g</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">0.8701</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.88</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.146</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.104</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.061</span> <span class="p">(</span><span class="mi">33</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.051</span> <span class="p">(</span><span class="mi">92</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>     <span class="o">-</span><span class="mf">0.201</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.05</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.09</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.13</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.13</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="n">d</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.21609</span> <span class="p">(</span><span class="mi">51</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.243</span> <span class="p">(</span><span class="mi">86</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>    <span class="o">-</span><span class="mf">0.4168</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.50</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>     <span class="o">-</span><span class="mf">0.240</span> <span class="p">(</span><span class="mi">35</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.268</span> <span class="p">(</span><span class="mi">91</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.07</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.07</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.47</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.21</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="n">e</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.19697</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.211</span> <span class="p">(</span><span class="mi">83</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.347</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.42</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>     <span class="o">-</span><span class="mf">0.275</span> <span class="p">(</span><span class="mi">38</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.30</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.19</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.31</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.06</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.26</span> <span class="p">(</span><span class="mi">23</span><span class="p">)</span>      <span class="p">[</span>  <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">----------------------------------------------------</span>
      <span class="n">etab</span><span class="o">.</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">0.25613</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.27</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.532</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.333</span> <span class="p">(</span><span class="mi">34</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.43</span> <span class="p">(</span><span class="mi">28</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.36</span> <span class="p">(</span><span class="mi">25</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.51</span> <span class="p">(</span><span class="mi">44</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.55</span> <span class="p">(</span><span class="mi">53</span><span class="p">)</span>      <span class="p">[</span>   <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">0.007</span><span class="o">/</span><span class="mi">130</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">60</span><span class="o">/</span><span class="mf">0.5</span><span class="p">)</span>

<span class="o">==============================</span> <span class="n">Results</span>

       <span class="n">E</span>            <span class="n">l</span>            <span class="n">g</span>           <span class="n">d</span>            <span class="n">e</span>          
    <span class="o">=================================================================</span>
     <span class="mi">0</span> <span class="mf">0.25613</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.50587</span><span class="p">(</span><span class="mi">94</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.8701</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.21609</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.19697</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span>
     <span class="mi">1</span> <span class="mf">0.788</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.395</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>    <span class="mf">0.146</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.4168</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.347</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  
     <span class="mi">2</span> <span class="mf">1.121</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>    <span class="mf">0.417</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>    <span class="mf">0.061</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.240</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.275</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>  
     <span class="mi">3</span> <span class="mf">1.55</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>    <span class="o">-</span><span class="mf">0.18</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>    <span class="o">-</span><span class="mf">0.201</span><span class="p">(</span><span class="mi">62</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.12</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>    <span class="o">-</span><span class="mf">0.19</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>   

       <span class="n">E</span>            <span class="mi">0</span>           <span class="mi">1</span>           <span class="mi">2</span>            <span class="mi">3</span>          
    <span class="o">================================================================</span>
     <span class="mi">0</span> <span class="mf">0.25613</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>  <span class="mf">0.9810</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>  <span class="mf">0.0069</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.00168</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>  <span class="mf">0.00156</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
     <span class="mi">1</span> <span class="mf">0.788</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.038</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>   <span class="mf">0.891</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.022</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>    <span class="mf">0.014</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>  
     <span class="mi">2</span> <span class="mf">1.121</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>    <span class="mf">0.011</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>   <span class="mf">0.060</span><span class="p">(</span><span class="mi">58</span><span class="p">)</span>   <span class="mf">0.854</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span>    <span class="mf">0.008</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>  
     <span class="mi">3</span> <span class="mf">1.55</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>     <span class="mf">0.251</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>   <span class="mf">0.15</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>    <span class="mf">0.08</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>    <span class="o">-</span><span class="mf">0.20</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>   

<span class="n">Values</span><span class="p">:</span>
         <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">0.532</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>           
         <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">0.865</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>           
  <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">1.627</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span>           

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                            <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span>        <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span>
<span class="o">--------------------------------------------------------------------------</span>
              <span class="n">prior</span><span class="p">:</span>              <span class="mf">0.59</span>              <span class="mf">2.67</span>              <span class="mf">2.44</span>
               <span class="n">data</span><span class="p">:</span>              <span class="mf">1.36</span>              <span class="mf">2.22</span>              <span class="mf">1.95</span>
             <span class="n">svdcut</span><span class="p">:</span>              <span class="mf">1.23</span>              <span class="mf">2.42</span>              <span class="mf">2.51</span>
<span class="o">--------------------------------------------------------------------------</span>
              <span class="n">total</span><span class="p">:</span>              <span class="mf">1.93</span>              <span class="mf">4.23</span>              <span class="mf">4.01</span>
</pre></div>
</div>
<p>The energies and amplitudes for the first three states are almost unchanged,
which gives us confidence in the original results.
Results for the fourth and higher states have larger errors, as expected.</p>
<p>Note that while the <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> value for this last fit is almost identical to
that in the  original fit, the Bayes Factor (from <code class="docutils literal notranslate"><span class="pre">logGBF</span></code>) is
exp(1277.1-1270.3)=899 times larger for the original fit. The Bayes Factor
gives us a sense of which prior the data prefer. Specifically it says that
our Monte Carlo data are 899 times more likely to have come from a model
with the original prior than from one with the more conservative prior. This
further reinforces our confidence in the original results.</p>
</div>
<div class="section" id="alternative-organization">
<h2>Alternative Organization<a class="headerlink" href="#alternative-organization" title="Permalink to this headline">¶</a></h2>
<p>Our <img class="math" src="_images/math/796bef5908cc057118322358f951a56a1bc1ae36.svg" alt="\eta_b"/> fit uses the <a class="reference internal" href="corrfitter.html#corrfitter.EigenBasis" title="corrfitter.EigenBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.EigenBasis</span></code></a> to construct a special prior for the fit,
but leaves the correlators unchanged. An alternative approach is  to project
the correlators unto the eigen-basis, and then to fit them with a fit function
defined directly in terms of the eigen-basis. This approach is conceptually
identical to that above, but in practice it gives somewhat different
results since the SVD cut  enters differently. A version of the code above
that uses this approach is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>   <span class="c1"># makes this work for python2 and 3</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">gvar</span> <span class="k">as</span> <span class="nn">gv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">corrfitter</span> <span class="k">as</span> <span class="nn">cf</span>

<span class="n">DISPLAYPLOTS</span> <span class="o">=</span> <span class="kc">False</span>         <span class="c1"># display plots at end of fits?</span>

<span class="n">SOURCES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
<span class="n">EIG_SOURCES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>                                      <span class="c1"># 1a</span>
<span class="n">KEYFMT</span> <span class="o">=</span> <span class="s1">&#39;1s0.</span><span class="si">{s1}{s2}</span><span class="s1">&#39;</span>
<span class="n">TDATA</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">SVDCUT</span> <span class="o">=</span> <span class="mf">0.06</span>                                                           <span class="c1"># 2</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="s1">&#39;etab.h5&#39;</span><span class="p">)</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CorrFitter</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">make_models</span><span class="p">())</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;nterm =&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="s1">&#39;m&#39;</span><span class="p">))</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pmean</span>
    <span class="n">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISPLAYPLOTS</span><span class="p">:</span>
        <span class="n">fitter</span><span class="o">.</span><span class="n">display_plots</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">==================== add svd, prior noise&#39;</span><span class="p">)</span>
    <span class="n">noisy_fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">pmean</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">,</span>
        <span class="n">noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">noisy_fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">dE</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">noisy_dE</span> <span class="o">=</span> <span class="n">noisy_fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      dE:&#39;</span><span class="p">,</span> <span class="n">dE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;noisy dE:&#39;</span><span class="p">,</span> <span class="n">noisy_dE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;          &#39;</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">fmt_chi2</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">dE</span> <span class="o">-</span> <span class="n">noisy_dE</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">make_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">avg_data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">EigenBasis</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;1s0.</span><span class="si">{s1}{s2}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">srcs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span>
        <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">tdata</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">basis</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;1s0.</span><span class="si">{s1}{s2}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">basis</span>              <span class="c1"># 3</span>

<span class="k">def</span> <span class="nf">make_models</span><span class="p">():</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">EIG_SOURCES</span><span class="p">):</span>                                <span class="c1"># 1b</span>
        <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="n">EIG_SOURCES</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>                                      <span class="c1"># 1c</span>
            <span class="n">tfit</span> <span class="o">=</span> <span class="n">TDATA</span> <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span> <span class="k">else</span> <span class="n">TDATA</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span>
            <span class="n">otherdata</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span> <span class="k">else</span> <span class="n">KEYFMT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s1</span><span class="p">)</span>
            <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">cf</span><span class="o">.</span><span class="n">Corr2</span><span class="p">(</span>
                    <span class="n">datatag</span><span class="o">=</span><span class="n">KEYFMT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">),</span>
                    <span class="n">tdata</span><span class="o">=</span><span class="n">TDATA</span><span class="p">,</span> <span class="n">tfit</span><span class="o">=</span><span class="n">tfit</span><span class="p">,</span>
                    <span class="n">a</span><span class="o">=</span><span class="s1">&#39;etab.&#39;</span> <span class="o">+</span> <span class="n">s1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s1">&#39;etab.&#39;</span> <span class="o">+</span> <span class="n">s2</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">,</span>
                    <span class="n">otherdata</span><span class="o">=</span><span class="n">otherdata</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
    <span class="k">return</span> <span class="n">models</span>

<span class="k">def</span> <span class="nf">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">basis</span><span class="o">.</span><span class="n">make_prior</span><span class="p">(</span><span class="n">nterm</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">eig_srcs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 4</span>

<span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;Results</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">keyfmt</span><span class="o">=</span><span class="s1">&#39;etab.</span><span class="si">{s1}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">eig_srcs</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etab.dE&#39;</span><span class="p">])</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;a*E(2s-1s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;a*E(3s-1s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;E(3s-1s)/E(2s-1s)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;prior&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;svdcut&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">correction</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">fmt_values</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">fmt_errorbudget</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">colwidth</span><span class="o">=</span><span class="mi">18</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">gv</span><span class="o">.</span><span class="n">ranseed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>This code has four changes from the original: it uses the eigen-sources for
building the models (<code class="docutils literal notranslate"><span class="pre">#1</span></code>); the SVD cut is different (<code class="docutils literal notranslate"><span class="pre">#2</span></code>); the data
are projected onto the eigen-basis (<code class="docutils literal notranslate"><span class="pre">#3</span></code>); and the prior is defined
for the eigen-sources (<code class="docutils literal notranslate"><span class="pre">#4</span></code>).</p>
<p>The fit results from the new code are very similar to before; there is
little difference between the two approaches in this case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.32</span> <span class="p">[</span><span class="mi">164</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1141.6</span>

<span class="n">Parameters</span><span class="p">:</span>
       <span class="n">etab</span><span class="o">.</span><span class="mi">0</span> <span class="mi">0</span>     <span class="mf">0.9811</span> <span class="p">(</span><span class="mi">23</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.00</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>    <span class="o">-</span><span class="mf">0.0320</span> <span class="p">(</span><span class="mi">83</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.030</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>     <span class="o">-</span><span class="mf">0.048</span> <span class="p">(</span><span class="mi">39</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.35</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.17</span> <span class="p">(</span><span class="mi">42</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.12</span> <span class="p">(</span><span class="mi">49</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etab</span><span class="o">.</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">1.3625</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.3</span> <span class="p">(</span><span class="mf">2.3</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.628</span> <span class="p">(</span><span class="mi">23</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">1.14</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.43</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.65</span> <span class="p">(</span><span class="mi">82</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.65</span> <span class="p">(</span><span class="mi">95</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.64</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="mi">1</span> <span class="mi">0</span>    <span class="mf">0.00625</span> <span class="p">(</span><span class="mi">92</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.896</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.00</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.052</span> <span class="p">(</span><span class="mi">57</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>     <span class="o">-</span><span class="mf">0.057</span> <span class="p">(</span><span class="mi">77</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.27</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.14</span> <span class="p">(</span><span class="mi">68</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.96</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="mi">2</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.00238</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.021</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.844</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.00</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="mf">0.024</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.41</span> <span class="p">(</span><span class="mi">55</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.71</span> <span class="p">(</span><span class="mi">44</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.04</span> <span class="p">(</span><span class="mi">78</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">etab</span><span class="o">.</span><span class="mi">3</span> <span class="mi">0</span>    <span class="mf">0.00155</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="mf">0.0082</span> <span class="p">(</span><span class="mi">90</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.001</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.03</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.94</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.00</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.18</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.08</span> <span class="p">(</span><span class="mi">25</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.04</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">---------------------------------------------------</span>
      <span class="n">etab</span><span class="o">.</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">0.25602</span> <span class="p">(</span><span class="mi">35</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.27</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.534</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="mf">0.319</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.65</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.52</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>       <span class="mf">0.52</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.53</span> <span class="p">(</span><span class="mi">51</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.62</span> <span class="p">(</span><span class="mi">62</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">0.06</span><span class="o">/</span><span class="mi">133</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">72</span><span class="o">/</span><span class="mf">0.5</span><span class="p">)</span>

<span class="o">==============================</span> <span class="n">Results</span>

       <span class="n">E</span>            <span class="n">l</span>           <span class="n">g</span>           <span class="n">d</span>            <span class="n">e</span>          
    <span class="o">================================================================</span>
     <span class="mi">0</span> <span class="mf">0.25602</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.5060</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.8703</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.21562</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.19652</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span>
     <span class="mi">1</span> <span class="mf">0.790</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.400</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>   <span class="mf">0.1416</span><span class="p">(</span><span class="mi">73</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.420</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.352</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>  
     <span class="mi">2</span> <span class="mf">1.109</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>    <span class="mf">0.404</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>   <span class="mf">0.042</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.237</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.275</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>  
     <span class="mi">3</span> <span class="mf">1.76</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>     <span class="mf">0.176</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>   <span class="mf">0.053</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.093</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>    <span class="mf">0.296</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>  

       <span class="n">E</span>            <span class="mi">0</span>           <span class="mi">1</span>            <span class="mi">2</span>            <span class="mi">3</span>          
    <span class="o">=================================================================</span>
     <span class="mi">0</span> <span class="mf">0.25602</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>  <span class="mf">0.9811</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>  <span class="mf">0.00625</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.00238</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="mf">0.00155</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
     <span class="mi">1</span> <span class="mf">0.790</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.0320</span><span class="p">(</span><span class="mi">83</span><span class="p">)</span>  <span class="mf">0.896</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.021</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>    <span class="mf">0.0082</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> 
     <span class="mi">2</span> <span class="mf">1.109</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>    <span class="mf">0.030</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>   <span class="mf">0.052</span><span class="p">(</span><span class="mi">57</span><span class="p">)</span>    <span class="mf">0.844</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>    <span class="mf">0.001</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>  
     <span class="mi">3</span> <span class="mf">1.76</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>    <span class="o">-</span><span class="mf">0.048</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>  <span class="o">-</span><span class="mf">0.057</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>    <span class="mf">0.024</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span>    <span class="mf">0.94</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>   

<span class="n">Values</span><span class="p">:</span>
         <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">0.534</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>           
         <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">0.853</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>           
  <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">):</span> <span class="mf">1.599</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>           

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                            <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span>        <span class="n">a</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="n">s</span><span class="p">)</span>
<span class="o">--------------------------------------------------------------------------</span>
              <span class="n">prior</span><span class="p">:</span>              <span class="mf">0.62</span>              <span class="mf">1.87</span>              <span class="mf">1.74</span>
               <span class="n">data</span><span class="p">:</span>              <span class="mf">1.34</span>              <span class="mf">2.08</span>              <span class="mf">1.65</span>
             <span class="n">svdcut</span><span class="p">:</span>              <span class="mf">1.76</span>              <span class="mf">3.10</span>              <span class="mf">3.69</span>
<span class="o">--------------------------------------------------------------------------</span>
              <span class="n">total</span><span class="p">:</span>              <span class="mf">2.30</span>              <span class="mf">4.17</span>              <span class="mf">4.40</span>
</pre></div>
</div>
<p>Projecting the correlators onto the eigen-basis makes off-diagonal
correlators much less important to the fit. Results are essentially
unchanged if only the diagonal elements of the matrix of correlators
are used in the fit.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Annotated Example: Matrix Correlator</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#code">Code</a></li>
<li><a class="reference internal" href="#results">Results</a></li>
<li><a class="reference internal" href="#setting-the-svd-cut">Setting the SVD Cut</a></li>
<li><a class="reference internal" href="#fit-stability">Fit Stability</a></li>
<li><a class="reference internal" href="#alternative-organization">Alternative Organization</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="example-etas-Ds.html"
                        title="previous chapter">Annotated Example: Transition Form Factor and Mixing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="corrfitter.html"
                        title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">corrfitter</span></code> - Least-Squares Fit to Correlators</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/example-etab.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="corrfitter.html" title="corrfitter - Least-Squares Fit to Correlators"
             >next</a> |</li>
        <li class="right" >
          <a href="example-etas-Ds.html" title="Annotated Example: Transition Form Factor and Mixing"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">corrfitter 8.1.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-19, G.P. Lepage.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Annotated Example: Transition Form Factor and Mixing &#8212; corrfitter 8.2 documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Annotated Example: Matrix Correlator" href="example-etab.html" />
    <link rel="prev" title="Annotated Example: Two-Point Correlator" href="example-etas.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example-etab.html" title="Annotated Example: Matrix Correlator"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="example-etas.html" title="Annotated Example: Two-Point Correlator"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">corrfitter 8.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="annotated-example-transition-form-factor-and-mixing">
<h1>Annotated Example: Transition Form Factor and Mixing<a class="headerlink" href="#annotated-example-transition-form-factor-and-mixing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Here we describe a complete Python code that uses <a class="reference internal" href="corrfitter.html#module-corrfitter" title="corrfitter: Least-Squares Fit to Correlators."><code class="xref py py-mod docutils literal notranslate"><span class="pre">corrfitter</span></code></a>
to calculate the transition matrix element or form factor from
an <img class="math" src="_images/math/474c72d29e9964d5dd5bd959e4b1d0bfc66a4a53.svg" alt="\eta_s"/> meson to a <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> meson, together with the masses and amplitudes
of these mesons. A very similar code, for (speculative) <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/>-<img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> mixing,
is described at the end.</p>
<p>The form factor example combines data from two-point correlators, for the
amplitudes and energies, with data from three-point correlators,
for the transition matrix element. We fit all of the correlators
together, in a single fit, in order to capture correlations between
the various output parameters. The correlations are built into
the output parameters and consequently are reflected in any
arithmetic combination of parameters — no bootstrap is needed to
calculate correlations or their impact on quantities derived
from the fit parameters. The best-fit parameters (in <code class="docutils literal notranslate"><span class="pre">fit.p</span></code>)
are objects of type <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>.</p>
<p>Staggered quarks are used in
this simulation, so the <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> has oscillating components as well as
normal components in its correlators.</p>
<p>The source codes (<code class="docutils literal notranslate"><span class="pre">etas-Ds.py</span></code>, <code class="docutils literal notranslate"><span class="pre">Ds-Ds.py</span></code>) and data files
(<code class="docutils literal notranslate"><span class="pre">etas-Ds.h5</span></code>, <code class="docutils literal notranslate"><span class="pre">Ds-Ds.h5</span></code>) are included with
the <a class="reference internal" href="corrfitter.html#module-corrfitter" title="corrfitter: Least-Squares Fit to Correlators."><code class="xref py py-mod docutils literal notranslate"><span class="pre">corrfitter</span></code></a> distribution, in the <code class="docutils literal notranslate"><span class="pre">examples/</span></code> directory.
The data are from the HPQCD collaboration.</p>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">main</span></code> method for the form-factor code follows the pattern described
in <a class="reference internal" href="overview.html#basic-fits"><span class="std std-ref">Basic Fits</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>   <span class="c1"># makes this work for python2 and 3</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">gvar</span> <span class="k">as</span> <span class="nn">gv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">corrfitter</span> <span class="k">as</span> <span class="nn">cf</span>

<span class="n">SHOWPLOTS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">SVDCUT</span> <span class="o">=</span> <span class="mf">8e-5</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="s1">&#39;etas-Ds.h5&#39;</span><span class="p">)</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CorrFitter</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">make_models</span><span class="p">())</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;nterm =&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="s1">&#39;v&#39;</span><span class="p">))</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pmean</span>
    <span class="n">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">SHOWPLOTS</span><span class="p">:</span>
        <span class="n">fit</span><span class="o">.</span><span class="n">show_plots</span><span class="p">()</span>
</pre></div>
</div>
<p>The Monte Carlo data are in a file named <code class="docutils literal notranslate"><span class="pre">'etas-Ds.h5'</span></code>. We are doing
four fits, with 1, 2, 3, and 4 terms in the fit function. Each fit starts its
minimization at point <code class="docutils literal notranslate"><span class="pre">p0</span></code>, which is set equal to the mean values of the
best-fit parameters from the previous fit (<code class="docutils literal notranslate"><span class="pre">p0</span> <span class="pre">=</span> <span class="pre">fit.pmean</span></code>). This reduces
the  number of iterations needed for convergence in the <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">4</span></code> fit, for
example, from 162 to 45. It also makes multi-term fits more stable.</p>
<p>After the fit, plots of the fit data divided by the fit
are displayed by <code class="docutils literal notranslate"><span class="pre">fit.show_plots()</span></code>, provided
<code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code> is installed. A plot is made for each correlator, and the
ratios should equal one to within errors. To
move from one plot to the next press “n” on the keyboard; to move to a
previous plot press “p”; to cycle through different views of the data and fit
press “v”; and to quit the plots press “q”.</p>
<p>We now look at each other major routine in turn.</p>
<div class="section" id="a-make-data">
<h3>a) make_data<a class="headerlink" href="#a-make-data" title="Permalink to this headline">¶</a></h3>
<p>Method <code class="docutils literal notranslate"><span class="pre">make_data('etas-Ds.h5')</span></code> reads in the Monte Carlo data, averages
it, and formats it for use by <a class="reference internal" href="corrfitter.html#corrfitter.CorrFitter" title="corrfitter.CorrFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.CorrFitter</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_data</span><span class="p">(</span><span class="n">datafile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Read data from datafile and average it. &quot;&quot;&quot;</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">avg_data</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
</pre></div>
</div>
<p>The data file <code class="docutils literal notranslate"><span class="pre">etas-Ds.h5</span></code> is in hdf5 format. It contains four datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;HDF5 dataset &quot;3ptT15&quot;: shape (225, 16), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;3ptT16&quot;: shape (225, 17), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;Ds&quot;: shape (225, 64), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;etas&quot;: shape (225, 64), type &quot;&lt;f8&quot;&gt;</span>
</pre></div>
</div>
<p>Each corresponds to Monte Carlo data for a single correlator, which
is packaged as a two-dimensional <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code> array whose
first index labels the Monte Carlo sample, and whose second index labels
time. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;etas&#39;</span><span class="p">][:,</span> <span class="p">:])</span>
<span class="go">[[ 0.305044   0.0789607  0.0331313 ...,  0.0164646  0.0332153  0.0791385]</span>
<span class="go"> [ 0.306573   0.0802435  0.0340765 ...,  0.0170088  0.034013   0.0801528]</span>
<span class="go"> [ 0.306194   0.0800234  0.0338007 ...,  0.0168862  0.0337728  0.0799462]</span>
<span class="go"> ...,</span>
<span class="go"> [ 0.305955   0.0797565  0.0335741 ...,  0.0167847  0.0336077  0.0796961]</span>
<span class="go"> [ 0.305661   0.0793606  0.0333133 ...,  0.0165365  0.0333934  0.0792943]</span>
<span class="go"> [ 0.305365   0.079379   0.033445  ...,  0.0164506  0.0332284  0.0792884]]</span>
</pre></div>
</div>
<p>is data for a two-point correlator describing the <img class="math" src="_images/math/474c72d29e9964d5dd5bd959e4b1d0bfc66a4a53.svg" alt="\eta_s"/>  meson. Each
of the 225 lines is a different Monte Carlo sample for the correlator, and
has 64 entries corresponding to <code class="docutils literal notranslate"><span class="pre">t=0,1...63</span></code>. Note the periodicity
in this data.</p>
<p>Function <code class="docutils literal notranslate"><span class="pre">gv.dataset.avg_data(dset)</span></code> averages over the Monte Carlo samples
for all the correlators to compute their means and covariance matrix.
The end result is a dictionary whose keys are the keys used to
label the hdf5 datasets: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="s1">&#39;etas-Ds.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;etas&#39;</span><span class="p">])</span>
<span class="go">[0.305808(29) 0.079613(24) 0.033539(17) ... 0.079621(24)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ds&#39;</span><span class="p">])</span>
<span class="go">[0.2307150(73) 0.0446523(32) 0.0089923(15) ... 0.0446527(32)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;3ptT16&#39;</span><span class="p">])</span>
<span class="go">[1.4583(21)e-10 3.3639(44)e-10 ... 0.000023155(30)]</span>
</pre></div>
</div>
<p>Here each entry in <code class="docutils literal notranslate"><span class="pre">data</span></code> is an array of <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s representing Monte
Carlo averages for the corresponding correlator at different times. This
is the format needed by <a class="reference internal" href="corrfitter.html#corrfitter.CorrFitter" title="corrfitter.CorrFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.CorrFitter</span></code></a>. Note that the different correlators
are correlated with each other: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">evalcorr</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;etas&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
<span class="go">[[ 1.          0.96432174]</span>
<span class="go"> [ 0.96432174  1.        ]]</span>
</pre></div>
</div>
<p>shows a 96% correlation between the <code class="docutils literal notranslate"><span class="pre">t=0</span></code> values in the <img class="math" src="_images/math/474c72d29e9964d5dd5bd959e4b1d0bfc66a4a53.svg" alt="\eta_s"/> and
<img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> correlators.</p>
</div>
<div class="section" id="b-make-models">
<h3>b) make_models<a class="headerlink" href="#b-make-models" title="Permalink to this headline">¶</a></h3>
<p>Method <code class="docutils literal notranslate"><span class="pre">make_models()</span></code> specifies the theoretical models that will be used
to fit the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_models</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Create models to fit data. &quot;&quot;&quot;</span>
    <span class="n">tmin</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">cf</span><span class="o">.</span><span class="n">Corr2</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;etas&#39;</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="n">tp</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
            <span class="n">a</span><span class="o">=</span><span class="s1">&#39;etas:a&#39;</span><span class="p">,</span>  <span class="n">b</span><span class="o">=</span><span class="s1">&#39;etas:a&#39;</span><span class="p">,</span>  <span class="n">dE</span><span class="o">=</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">,</span>
            <span class="p">),</span>

        <span class="n">cf</span><span class="o">.</span><span class="n">Corr2</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;Ds&#39;</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="n">tp</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
            <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:a&#39;</span><span class="p">),</span> <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:a&#39;</span><span class="p">),</span> <span class="n">dE</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:dE&#39;</span><span class="p">),</span>
            <span class="p">),</span>

        <span class="n">cf</span><span class="o">.</span><span class="n">Corr3</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;3ptT15&#39;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s1">&#39;etas:a&#39;</span><span class="p">,</span> <span class="n">dEa</span><span class="o">=</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">,</span>
            <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:a&#39;</span><span class="p">),</span> <span class="n">dEb</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:dE&#39;</span><span class="p">),</span>
            <span class="n">Vnn</span><span class="o">=</span><span class="s1">&#39;Vnn&#39;</span><span class="p">,</span> <span class="n">Vno</span><span class="o">=</span><span class="s1">&#39;Vno&#39;</span><span class="p">,</span>
            <span class="p">),</span>

        <span class="n">cf</span><span class="o">.</span><span class="n">Corr3</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;3ptT16&#39;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s1">&#39;etas:a&#39;</span><span class="p">,</span> <span class="n">dEa</span><span class="o">=</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">,</span>
            <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:a&#39;</span><span class="p">),</span> <span class="n">dEb</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">,</span> <span class="s1">&#39;Dso:dE&#39;</span><span class="p">),</span>
            <span class="n">Vnn</span><span class="o">=</span><span class="s1">&#39;Vnn&#39;</span><span class="p">,</span> <span class="n">Vno</span><span class="o">=</span><span class="s1">&#39;Vno&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">models</span>
</pre></div>
</div>
<p>Four models are specified, one for each correlator to be fit. The first two
are for the <img class="math" src="_images/math/474c72d29e9964d5dd5bd959e4b1d0bfc66a4a53.svg" alt="\eta_s"/> and <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> two-point correlators, corresponding to
entries in the data dictionary with keys <code class="docutils literal notranslate"><span class="pre">'etas'</span></code> and <code class="docutils literal notranslate"><span class="pre">'Ds'</span></code>,
respectively.
These are periodic propagators, with period 64 (<code class="docutils literal notranslate"><span class="pre">tp</span></code>), and we want to
omit the first and last 5 (<code class="docutils literal notranslate"><span class="pre">tmin</span></code>) time steps in the correlator.
Labels for the fit parameters corresponding to the
sources (and sinks) are specified for each, <code class="docutils literal notranslate"><span class="pre">'etas:a'</span></code> and <code class="docutils literal notranslate"><span class="pre">'Ds:a'</span></code>, as
are labels for the energy differences, <code class="docutils literal notranslate"><span class="pre">'etas:dE'</span></code> and <code class="docutils literal notranslate"><span class="pre">'Ds:dE'</span></code>.  The
<img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> propagator also has an oscillating piece because this data comes from
a staggered-quark analysis. Sources/sinks and energy differences are
specified for these as well: <code class="docutils literal notranslate"><span class="pre">'Dso:a'</span></code> and <code class="docutils literal notranslate"><span class="pre">'Dso:dE'</span></code>.</p>
<p>Finally three-point models are specified for the data corresponding to
data-dictionary keys <code class="docutils literal notranslate"><span class="pre">'3ptT15'</span></code> and <code class="docutils literal notranslate"><span class="pre">'3ptT16'</span></code>. These share several
parameters with the two-point correlators, but introduce new parameters
for the transition matrix elements: <code class="docutils literal notranslate"><span class="pre">'Vnn'</span></code> connecting normal states, and
<code class="docutils literal notranslate"><span class="pre">'Vno'</span></code> connecting normal states with oscillating states.</p>
</div>
<div class="section" id="c-make-prior">
<h3>c) make_prior<a class="headerlink" href="#c-make-prior" title="Permalink to this headline">¶</a></h3>
<p>Method <code class="docutils literal notranslate"><span class="pre">make_prior(N)</span></code> creates <em>a priori</em> estimates for each fit
parameter, to be used as  priors in the fitter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create priors for fit parameters. &quot;&quot;&quot;</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">BufferDict</span><span class="p">()</span>
    <span class="c1"># etas</span>
    <span class="n">metas</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="s1">&#39;0.4(2)&#39;</span><span class="p">)</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(etas:a)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.3(3)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(etas:dE)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.5(5)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(etas:dE)&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">metas</span><span class="p">)</span>

    <span class="c1"># Ds</span>
    <span class="n">mDs</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="s1">&#39;1.2(2)&#39;</span><span class="p">)</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(Ds:a)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.3(3)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(Ds:dE)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.5(5)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(Ds:dE)&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mDs</span><span class="p">)</span>

    <span class="c1"># Ds -- oscillating part</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(Dso:a)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.1(1)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(Dso:dE)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.5(5)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(Dso:dE)&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mDs</span> <span class="o">+</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="s1">&#39;0.3(3)&#39;</span><span class="p">))</span>

    <span class="c1"># V</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0(1)&#39;</span><span class="p">]])</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Vno&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0(1)&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">prior</span>
</pre></div>
</div>
<p>Parameter <code class="docutils literal notranslate"><span class="pre">N</span></code> specifies how many terms are kept in the fit functions. The
priors are stored in a dictionary <code class="docutils literal notranslate"><span class="pre">prior</span></code>. Each entry is an array, of
length <code class="docutils literal notranslate"><span class="pre">N</span></code>, with one entry for each term in the fit function.
Each entry is a Gaussian random
variable, an object of type  <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>. Here we use the fact that
<code class="docutils literal notranslate"><span class="pre">gvar.gvar()</span></code> can make a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s from a list of strings of the form
<code class="docutils literal notranslate"><span class="pre">'0.1(1)'</span></code>: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">([</span><span class="s1">&#39;1(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;3(2)&#39;</span><span class="p">]))</span>
<span class="go">[1.0(2.0) 3.0(2.0)]</span>
</pre></div>
</div>
<p>In this particular fit, we can assume that all the sinks/sources
are positive, and we can require that the energy differences be positive. To
force positivity, we use log-normal distributions for these parameters by
defining priors for <code class="docutils literal notranslate"><span class="pre">'log(etas:a)'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log(etas:dE)'</span></code> … rather than
<code class="docutils literal notranslate"><span class="pre">'etas:a'</span></code>,  <code class="docutils literal notranslate"><span class="pre">'etas:dE'</span></code> … (see <a class="reference internal" href="faster.html#positive-parameters"><span class="std std-ref">Postive Parameters</span></a>). The <em>a
priori</em> values for these fit parameters are the logarithms of the values for
the parameters themselves: for example, each <code class="docutils literal notranslate"><span class="pre">'etas:a'</span></code> has prior <code class="docutils literal notranslate"><span class="pre">0.3(3)</span></code>,
while the actual fit parameters, <code class="docutils literal notranslate"><span class="pre">log(etas:a)</span></code>, have priors
<code class="docutils literal notranslate"><span class="pre">log(0.3(3))</span> <span class="pre">=</span> <span class="pre">-1.2(1.0)</span></code>.</p>
<p>We override the default priors for the ground-state energies in each case.
This is not unusual since <code class="docutils literal notranslate"><span class="pre">dE[0]</span></code>, unlike the other <code class="docutils literal notranslate"><span class="pre">dE</span></code>s,  is an energy,
not an energy difference. For the oscillating <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> state, we require
that its mass be <code class="docutils literal notranslate"><span class="pre">0.3(3)</span></code> larger than the <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> mass. One could  put
more precise information into the priors if that made sense given the goals
of the simulation. For example, if the main objective is a value for <code class="docutils literal notranslate"><span class="pre">Vnn</span></code>,
one might include fairly exact information about the <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> and
<img class="math" src="_images/math/474c72d29e9964d5dd5bd959e4b1d0bfc66a4a53.svg" alt="\eta_s"/> masses in the prior, using results from experiment or from
earlier simulations. This would make no sense, however, if the goal is to
verify that simulations gives correct masses.</p>
<p>Note, finally, that a statement like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="n">N</span><span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0(1)&#39;</span><span class="p">]])</span>       <span class="c1"># correct</span>
</pre></div>
</div>
<p>is <em>not</em> the same as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="s1">&#39;0(1)&#39;</span><span class="p">)]]</span>      <span class="c1"># wrong</span>
</pre></div>
</div>
<p>The former creates <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">**</span> <span class="pre">2</span></code> independent <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s, with one for each element
of <code class="docutils literal notranslate"><span class="pre">Vnn</span></code>; it is one of the most succinct ways of creating a large number of
<code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s. The latter creates only a single <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code> and uses it repeatedly for
every element <code class="docutils literal notranslate"><span class="pre">Vnn</span></code>, thereby forcing every element of <code class="docutils literal notranslate"><span class="pre">Vnn</span></code>  to be equal
to every other element when fitting (since the difference between any two of
their priors is <code class="docutils literal notranslate"><span class="pre">0±0</span></code>); it is almost certainly not what is desired.
Usually one wants to create the array of strings first, and then convert it to
<code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code>s using <code class="docutils literal notranslate"><span class="pre">gvar.gvar()</span></code>.</p>
</div>
<div class="section" id="d-print-results">
<h3>d) print_results<a class="headerlink" href="#d-print-results" title="Permalink to this headline">¶</a></h3>
<p>Method <code class="docutils literal notranslate"><span class="pre">print_results(fit,</span> <span class="pre">prior,</span> <span class="pre">data)</span></code> reports on the best-fit values
for the fit parameters from the last fit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Report best-fit results. &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit results:&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span>                       <span class="c1"># best-fit parameters</span>

    <span class="c1"># etas</span>
    <span class="n">E_etas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">])</span>
    <span class="n">a_etas</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;etas:a&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Eetas:&#39;</span><span class="p">,</span> <span class="n">E_etas</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  aetas:&#39;</span><span class="p">,</span> <span class="n">a_etas</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># Ds</span>
    <span class="n">E_Ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">])</span>
    <span class="n">a_Ds</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  EDs:&#39;</span><span class="p">,</span> <span class="n">E_Ds</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span>  <span class="s1">&#39;  aDs:&#39;</span><span class="p">,</span> <span class="n">a_Ds</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># Dso -- oscillating piece</span>
    <span class="n">E_Dso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;Dso:dE&#39;</span><span class="p">])</span>
    <span class="n">a_Dso</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Dso:a&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  EDso:&#39;</span><span class="p">,</span> <span class="n">E_Dso</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span>  <span class="s1">&#39;  aDso:&#39;</span><span class="p">,</span> <span class="n">a_Dso</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># V</span>
    <span class="n">Vnn</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  etas-&gt;V-&gt;Ds  =&#39;</span><span class="p">,</span> <span class="n">Vnn</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1"># error budget</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;metas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_etas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;mDs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_Ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vnn</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;statistics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>         <span class="c1"># statistical errors in data</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;svd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">correction</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>                <span class="c1"># all entries in prior</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">gv</span><span class="o">.</span><span class="n">fmt_values</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">fmt_errorbudget</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">inputs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The best-fit parameter values are stored in dictionary <code class="docutils literal notranslate"><span class="pre">p=fit.p</span></code>,
as are the exponentials of the log-normal parameters.
We also turn energy differences into energies using <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code>’s cummulative
sum function <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.cumsum()</span></code>. The final output is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fit</span> <span class="n">results</span><span class="p">:</span>
  <span class="n">Eetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">1.013</span><span class="p">(</span><span class="mi">83</span><span class="p">)</span> <span class="mf">1.46</span><span class="p">(</span><span class="mi">36</span><span class="p">)]</span>
  <span class="n">aetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21834</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="mf">0.176</span><span class="p">(</span><span class="mi">69</span><span class="p">)</span> <span class="mf">0.30</span><span class="p">(</span><span class="mi">14</span><span class="p">)]</span>

  <span class="n">EDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.20165</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="mf">1.703</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="mf">2.24</span><span class="p">(</span><span class="mi">22</span><span class="p">)]</span>
  <span class="n">aDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21467</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="mf">0.273</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="mf">0.47</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>

  <span class="n">EDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.445</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="mf">1.68</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">2.18</span><span class="p">(</span><span class="mi">45</span><span class="p">)]</span>
  <span class="n">aDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0657</span><span class="p">(</span><span class="mi">73</span><span class="p">)</span> <span class="mf">0.082</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="mf">0.115</span><span class="p">(</span><span class="mi">93</span><span class="p">)]</span>

  <span class="n">etas</span><span class="o">-&gt;</span><span class="n">V</span><span class="o">-&gt;</span><span class="n">Ds</span>  <span class="o">=</span> <span class="mf">0.76716</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally we  create an error budget for the <img class="math" src="_images/math/474c72d29e9964d5dd5bd959e4b1d0bfc66a4a53.svg" alt="\eta_s"/>
and <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> masses, and for the ground-state transition amplitude
<code class="docutils literal notranslate"><span class="pre">Vnn</span></code>. The quantities of interest are specified in dictionary
<code class="docutils literal notranslate"><span class="pre">outputs</span></code>. For the error budget, we need another dictionary, <code class="docutils literal notranslate"><span class="pre">inputs</span></code>,
specifying various inputs to the calculation, here the Monte Carlo data,
the SVD corrections, and the
priors. Each of these inputs
contributes to the errors in the  final results, as detailed in the
error budget:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Values</span><span class="p">:</span>
              <span class="n">metas</span><span class="p">:</span> <span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>         
                <span class="n">mDs</span><span class="p">:</span> <span class="mf">1.20165</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>         
                <span class="n">Vnn</span><span class="p">:</span> <span class="mf">0.76716</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>         

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                  <span class="n">metas</span>       <span class="n">mDs</span>       <span class="n">Vnn</span>
<span class="o">-------------------------------------------</span>
  <span class="n">statistics</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.09</span>
         <span class="n">svd</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
<span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.02</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.02</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
 <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
         <span class="n">Vnn</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.04</span>
         <span class="n">Vno</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
<span class="o">-------------------------------------------</span>
       <span class="n">total</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.11</span>
</pre></div>
</div>
<p>The error budget shows, for example, that the largest sources of uncertainty
in every quantity are the statistical errors in the input data.</p>
</div>
<div class="section" id="e-svd-cut">
<h3>e) SVD Cut<a class="headerlink" href="#e-svd-cut" title="Permalink to this headline">¶</a></h3>
<p>The fits need an SVD cut, <code class="docutils literal notranslate"><span class="pre">svdcut=8e-5</span></code>, because there are
only 225 random samples for
each of 69 data points. Following the recipe in <a class="reference internal" href="faster.html#svd-cuts"><span class="std std-ref">Accurate Fits — SVD Cuts</span></a>,
we determine the value of the SVD cut using a separate
script consisting of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gvar</span> <span class="k">as</span> <span class="nn">gv</span>
<span class="kn">import</span> <span class="nn">corrfitter</span> <span class="k">as</span> <span class="nn">cf</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="s1">&#39;etas-Ds.h5&#39;</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">svd_diagnosis</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="n">make_models</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;svdcut =&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">svdcut</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">plot_ratio</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>together with the <code class="docutils literal notranslate"><span class="pre">make_models()</span></code> method described above.
Running this script outputs a single line, telling us
to use <code class="docutils literal notranslate"><span class="pre">svdcut=8e-5</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">svdcut</span> <span class="o">=</span> <span class="mf">7.897481075407619e-05</span>
</pre></div>
</div>
<p>It also displays a plot that shows how eigenvalues
of the data’s correlation matrix that are below the SVD cutoff (dotted
red line) are significantly underestimated:</p>
<a class="reference internal image-reference" href="_images/etas-Ds-svdcut.png"><img alt="_images/etas-Ds-svdcut.png" src="_images/etas-Ds-svdcut.png" style="width: 70%;" /></a>
<p>The SVD cut adds additional uncertainty to the data to increase
these eigenvalues so they do not cause trouble with the fit.</p>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>The output from running the code is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.8e+03</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">0</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.9877e+05</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">22</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">28</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span>

<span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.2</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">2.8e-08</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1546.1</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">22</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">29</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span>

<span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.58</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1593.5</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">22</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">49</span><span class="o">/</span><span class="mf">0.2</span><span class="p">)</span>

<span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.58</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mi">1594</span>

<span class="n">Parameters</span><span class="p">:</span>
  <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>     <span class="o">-</span><span class="mf">1.52169</span> <span class="p">(</span><span class="mi">74</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">1.74</span> <span class="p">(</span><span class="mi">39</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">1.20</span> <span class="p">(</span><span class="mi">47</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">1.27</span> <span class="p">(</span><span class="mi">96</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>     <span class="o">-</span><span class="mf">0.87663</span> <span class="p">(</span><span class="mi">28</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.92</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">0.52</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.81</span> <span class="p">(</span><span class="mi">65</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.66</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
    <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>     <span class="o">-</span><span class="mf">1.53866</span> <span class="p">(</span><span class="mi">95</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>       <span class="o">-</span><span class="mf">1.298</span> <span class="p">(</span><span class="mi">93</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.76</span> <span class="p">(</span><span class="mi">40</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">1.11</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>      <span class="mf">0.18370</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.18</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>       <span class="o">-</span><span class="mf">0.691</span> <span class="p">(</span><span class="mi">41</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.62</span> <span class="p">(</span><span class="mi">37</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.76</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>        <span class="o">-</span><span class="mf">2.72</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">2.50</span> <span class="p">(</span><span class="mi">38</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">2.17</span> <span class="p">(</span><span class="mi">81</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>       <span class="mf">0.3680</span> <span class="p">(</span><span class="mi">93</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.41</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">1.46</span> <span class="p">(</span><span class="mi">49</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.69</span> <span class="p">(</span><span class="mi">78</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vnn</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>      <span class="mf">0.76716</span> <span class="p">(</span><span class="mi">85</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>       <span class="o">-</span><span class="mf">0.491</span> <span class="p">(</span><span class="mi">39</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">2</span>         <span class="mf">0.39</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">3</span>         <span class="mf">0.05</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>        <span class="mf">0.060</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>         <span class="mf">0.38</span> <span class="p">(</span><span class="mi">77</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>       <span class="mf">0.03</span> <span class="p">(</span><span class="mf">1.00</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>     <span class="mf">0.002</span> <span class="p">(</span><span class="mf">1.000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">0</span>        <span class="o">-</span><span class="mf">0.11</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>       <span class="mf">0.04</span> <span class="p">(</span><span class="mf">1.00</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>     <span class="mf">0.001</span> <span class="p">(</span><span class="mf">1.000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">3</span>        <span class="mf">5e-05</span> <span class="o">+-</span> <span class="mi">1</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">0</span>      <span class="o">-</span><span class="mf">0.002</span> <span class="p">(</span><span class="mi">981</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>     <span class="mf">0.003</span> <span class="p">(</span><span class="mf">1.000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">2</span>        <span class="mf">3e-05</span> <span class="o">+-</span> <span class="mi">1</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>        <span class="mf">5e-07</span> <span class="o">+-</span> <span class="mi">1</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vno</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>       <span class="o">-</span><span class="mf">0.778</span> <span class="p">(</span><span class="mi">76</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>         <span class="mf">0.30</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">2</span>        <span class="o">-</span><span class="mf">0.02</span> <span class="p">(</span><span class="mi">88</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">3</span>     <span class="mf">0.007</span> <span class="p">(</span><span class="mf">0.998</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>         <span class="mf">0.26</span> <span class="p">(</span><span class="mi">44</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>         <span class="mf">0.17</span> <span class="p">(</span><span class="mi">96</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>     <span class="mf">0.005</span> <span class="p">(</span><span class="mf">0.999</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>   <span class="mf">0.0001</span> <span class="p">(</span><span class="mf">1.0000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">0</span>        <span class="o">-</span><span class="mf">0.14</span> <span class="p">(</span><span class="mi">94</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>     <span class="mf">0.003</span> <span class="p">(</span><span class="mf">1.000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>   <span class="mf">0.0006</span> <span class="p">(</span><span class="mf">1.0000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">3</span>        <span class="mf">1e-05</span> <span class="o">+-</span> <span class="mi">1</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">0</span>      <span class="o">-</span><span class="mf">0.02</span> <span class="p">(</span><span class="mf">1.00</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>    <span class="o">-</span><span class="mf">0.002</span> <span class="p">(</span><span class="mf">1.000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">2</span>        <span class="mf">9e-06</span> <span class="o">+-</span> <span class="mi">1</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>        <span class="mf">3e-07</span> <span class="o">+-</span> <span class="mi">1</span>       <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">------------------------------------------------------</span>
       <span class="n">etas</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>      <span class="mf">0.21834</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.176</span> <span class="p">(</span><span class="mi">69</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>         <span class="mf">0.30</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.28</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
      <span class="n">etas</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>      <span class="mf">0.41618</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.40</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.597</span> <span class="p">(</span><span class="mi">83</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>         <span class="mf">0.45</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.52</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
         <span class="n">Ds</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>      <span class="mf">0.21467</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.273</span> <span class="p">(</span><span class="mi">25</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>         <span class="mf">0.47</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.33</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Ds</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>      <span class="mf">1.20165</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">1.20</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.501</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>         <span class="mf">0.54</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.47</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Dso</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>       <span class="mf">0.0657</span> <span class="p">(</span><span class="mi">73</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.082</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="mf">0.115</span> <span class="p">(</span><span class="mi">93</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">Dso</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>        <span class="mf">1.445</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">1.50</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>         <span class="mf">0.23</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>         <span class="mf">0.50</span> <span class="p">(</span><span class="mi">39</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.49</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">22</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">20</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">Fit</span> <span class="n">results</span><span class="p">:</span>
  <span class="n">Eetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">1.013</span><span class="p">(</span><span class="mi">83</span><span class="p">)</span> <span class="mf">1.46</span><span class="p">(</span><span class="mi">36</span><span class="p">)]</span>
  <span class="n">aetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21834</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="mf">0.176</span><span class="p">(</span><span class="mi">69</span><span class="p">)</span> <span class="mf">0.30</span><span class="p">(</span><span class="mi">14</span><span class="p">)]</span>

  <span class="n">EDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.20165</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="mf">1.703</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="mf">2.24</span><span class="p">(</span><span class="mi">22</span><span class="p">)]</span>
  <span class="n">aDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21467</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="mf">0.273</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="mf">0.47</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>

  <span class="n">EDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.445</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="mf">1.68</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">2.18</span><span class="p">(</span><span class="mi">45</span><span class="p">)]</span>
  <span class="n">aDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0657</span><span class="p">(</span><span class="mi">73</span><span class="p">)</span> <span class="mf">0.082</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="mf">0.115</span><span class="p">(</span><span class="mi">93</span><span class="p">)]</span>

  <span class="n">etas</span><span class="o">-&gt;</span><span class="n">V</span><span class="o">-&gt;</span><span class="n">Ds</span>  <span class="o">=</span> <span class="mf">0.76716</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>

<span class="n">Values</span><span class="p">:</span>
              <span class="n">metas</span><span class="p">:</span> <span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>         
                <span class="n">mDs</span><span class="p">:</span> <span class="mf">1.20165</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>         
                <span class="n">Vnn</span><span class="p">:</span> <span class="mf">0.76716</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>         

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                  <span class="n">metas</span>       <span class="n">mDs</span>       <span class="n">Vnn</span>
<span class="o">-------------------------------------------</span>
  <span class="n">statistics</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.09</span>
         <span class="n">svd</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
<span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.02</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.02</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
 <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
         <span class="n">Vnn</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.04</span>
         <span class="n">Vno</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
<span class="o">-------------------------------------------</span>
       <span class="n">total</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.11</span>
</pre></div>
</div>
<p>Note:</p>
<ul>
<li><p>This is a relatively simple fit, taking only a second or so on a
laptop.</p></li>
<li><p>Fits with only one or two terms in the fit function are poor, with
<code class="docutils literal notranslate"><span class="pre">chi2/dof</span></code>s that are significantly larger than one.</p></li>
<li><p>Fits with three terms work well, and adding futher terms has almost no
impact. The <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> does not improve and parameters for the
added terms differ little from their prior values (since the data are
not sufficiently accurate to add new information).</p></li>
<li><p>The quality of the fit is confirmed by the fit plots displayed at the
end (press the ‘n’ and ‘p’ keys to cycle through the various plots,
the ‘v’ key to cycle through different views of the data and fit,
and the ‘q’ key to quit the plot). The plot for the <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> correlator,
for example, shows correlator data divided by fit result as a
function of <code class="docutils literal notranslate"><span class="pre">t</span></code>:</p>
<a class="reference internal image-reference" href="_images/Ds.png"><img alt="_images/Ds.png" src="_images/Ds.png" style="width: 70%;" /></a>
<p>The points with error bars are the correlator data points; the fit
result is 1.0 in this plot, of course, and the shaded band shows the
uncertainty in the fit function evaluated with the best-fit parameters.
Fit and data agree to within errors. Note how the fit-function errors
(the shaded band) track the data errors. In general the fit function
is at least as accurate as the data. It can be much more accurate,
for example, when the data errors grow rapidly with <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</li>
<li><p>In many applications precision can be improved by factors of 2—3 or more
by using multiple sources and sinks for the correlators. The code here
is easily generalized to handle such a situation: each
<a class="reference internal" href="corrfitter.html#corrfitter.Corr2" title="corrfitter.Corr2"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.Corr2</span></code></a> and <a class="reference internal" href="corrfitter.html#corrfitter.Corr3" title="corrfitter.Corr3"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.Corr3</span></code></a> in <code class="docutils literal notranslate"><span class="pre">make_models()</span></code>
is replicated with various different combinations of sources and
sinks (one entry for each combination).</p></li>
</ul>
</div>
<div class="section" id="testing-the-fit">
<h2>Testing the Fit<a class="headerlink" href="#testing-the-fit" title="Permalink to this headline">¶</a></h2>
<p>The <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> for the fit above is low for a fit to 69 data points.
This would normally be evidence of a good fit, but, as
discussed in <a class="reference internal" href="faster.html#goodness-of-fit"><span class="std std-ref">Goodness of Fit</span></a>,
our SVD cut means that we need
to refit with added noise if we want to use <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> as a measure of
fit quality.
We implement this test by adding the following code at the end of the
<code class="docutils literal notranslate"><span class="pre">main()</span></code> method  above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># check fit quality by adding noise</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">==================== add svd, prior noise&#39;</span><span class="p">)</span>
    <span class="n">noisy_fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">pmean</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">,</span>
        <span class="n">noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">noisy_fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">key_parameters</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
    <span class="n">noisy_p</span> <span class="o">=</span> <span class="n">key_parameters</span><span class="p">(</span><span class="n">noisy_fit</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      fit:&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;noisy fit:&#39;</span><span class="p">,</span> <span class="n">noisy_p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;          &#39;</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">fmt_chi2</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">noisy_p</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">key_parameters</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; collect key fit parameters in dictionary &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">BufferDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;etas:a&#39;</span><span class="p">,</span> <span class="s1">&#39;etas:dE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ds:a&#39;</span><span class="p">,</span> <span class="s1">&#39;Ds:dE&#39;</span><span class="p">]:</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ans</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ans</span>
</pre></div>
</div>
<p>This reruns the fit but with random noise (associated with the SVD cut
and priors) added to the data. The result is still a good fit, but with
a signficantly higher <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/>, as expected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================</span> <span class="n">add</span> <span class="n">svd</span><span class="p">,</span> <span class="n">prior</span> <span class="n">noise</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.94</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.63</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1580.5</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">22</span><span class="o">*</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">260</span><span class="o">/</span><span class="mf">1.1</span><span class="p">)</span>

      <span class="n">fit</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;etas:a&#39;</span><span class="p">:</span> <span class="mf">0.21834</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">:</span> <span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">:</span> <span class="mf">0.21467</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">:</span> <span class="mf">1.20165</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;Vnn&#39;</span><span class="p">:</span> <span class="mf">0.76716</span><span class="p">(</span><span class="mi">85</span><span class="p">)}</span>
<span class="n">noisy</span> <span class="n">fit</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;etas:a&#39;</span><span class="p">:</span> <span class="mf">0.21831</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">:</span> <span class="mf">0.41619</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">:</span> <span class="mf">0.21457</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">:</span> <span class="mf">1.20162</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="s1">&#39;Vnn&#39;</span><span class="p">:</span> <span class="mf">0.7660</span><span class="p">(</span><span class="mi">16</span><span class="p">)}</span>
           <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="o">=</span> <span class="mf">0.72</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.61</span>
</pre></div>
</div>
<p>The noisy fit also agrees with the original fit about the most important
parameters from the fit. This test provides further evidence that
our fit is good.</p>
<p>A more complex test of the fitting protocol is obtained by using
simulated fits: see <a class="reference internal" href="overview.html#simulated-fits"><span class="std std-ref">Testing Fits with Simulated Data</span></a>. We do this by adding</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># simulated fit</span>
    <span class="k">for</span> <span class="n">sim_pdata</span> <span class="ow">in</span> <span class="n">fitter</span><span class="o">.</span><span class="n">simulated_pdata_iter</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read_dataset</span><span class="p">(</span><span class="s1">&#39;etas-Ds.h5&#39;</span><span class="p">),</span> <span class="n">p_exact</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">pmean</span>
        <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">==================== simulation&#39;</span><span class="p">)</span>
        <span class="n">sim_fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span>
            <span class="n">pdata</span><span class="o">=</span><span class="n">sim_pdata</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">pmean</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">sim_fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">key_parameters</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">pmean</span><span class="p">)</span>
        <span class="n">sim_p</span> <span class="o">=</span> <span class="n">key_parameters</span><span class="p">(</span><span class="n">sim_fit</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;simulated - exact:&#39;</span><span class="p">,</span> <span class="n">sim_p</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;          &#39;</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">fmt_chi2</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">sim_p</span><span class="p">)))</span>
</pre></div>
</div>
<p>to the end of the <code class="docutils literal notranslate"><span class="pre">main()</span></code> method. This code does <code class="docutils literal notranslate"><span class="pre">n=2</span></code> simulations
of the full fit, using the means <code class="docutils literal notranslate"><span class="pre">fit.pmean</span></code> from the last fit
as <code class="docutils literal notranslate"><span class="pre">p_exact</span></code>.
The code compares fit results with <code class="docutils literal notranslate"><span class="pre">p_exact</span></code> in each case,
and computes the <img class="math" src="_images/math/2b01024bf11fcc819bfbd2bfda455169af2b8cba.svg" alt="\chi^2"/> of the difference between the leading parameters
and <code class="docutils literal notranslate"><span class="pre">p_exact</span></code>. The output is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================</span> <span class="n">simulation</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.35</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1601.6</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">24</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">58</span><span class="o">/</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">simulated</span> <span class="o">-</span> <span class="n">exact</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;etas:a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00009</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00007</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">,</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00002</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;Vnn&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0003</span><span class="p">(</span><span class="mi">11</span><span class="p">)}</span>
           <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="o">=</span> <span class="mf">0.11</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.99</span>

<span class="o">====================</span> <span class="n">simulation</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.66</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.99</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1591.1</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">24</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">50</span><span class="o">/</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">simulated</span> <span class="o">-</span> <span class="n">exact</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;etas:a&#39;</span><span class="p">:</span> <span class="mf">0.00008</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">:</span> <span class="mf">0.00007</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00003</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">:</span> <span class="mf">0.00006</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="s1">&#39;Vnn&#39;</span><span class="p">:</span> <span class="mf">0.0003</span><span class="p">(</span><span class="mi">13</span><span class="p">)}</span>
           <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="o">=</span> <span class="mf">0.21</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.96</span>
</pre></div>
</div>
<p>This again confirms that the fit is working well.</p>
</div>
<div class="section" id="variation-marginalization">
<h2>Variation: Marginalization<a class="headerlink" href="#variation-marginalization" title="Permalink to this headline">¶</a></h2>
<p>Marginalization (see <a class="reference internal" href="faster.html#marginalization"><span class="std std-ref">Marginalization</span></a>) can speed up fits like
this one. To use an 8-term fit function, while tuning parameters for only
<code class="docutils literal notranslate"><span class="pre">N</span></code> terms, we change only four lines in the main program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="s1">&#39;etas-Ds.h5&#39;</span><span class="p">)</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CorrFitter</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">make_models</span><span class="p">())</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>                                               <span class="c1"># 1</span>
    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>                                                    <span class="c1"># 2</span>
        <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;nterm =&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">lsqfit</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">nterm</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">SVDCUT</span>  <span class="c1"># 3</span>
            <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>                                                      <span class="c1"># 4</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pmean</span>
    <span class="n">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISPLAYPLOTS</span><span class="p">:</span>
        <span class="n">fit</span><span class="o">.</span><span class="n">show_plots</span><span class="p">()</span>
</pre></div>
</div>
<p>The first modification (<code class="docutils literal notranslate"><span class="pre">#1</span></code>) sets the prior to eight terms,
no matter what value <code class="docutils literal notranslate"><span class="pre">N</span></code> has.
The second modification (<code class="docutils literal notranslate"><span class="pre">#2</span></code>)
limits the
fits to <code class="docutils literal notranslate"><span class="pre">N=1,2</span></code>, because that is all that will be needed to get good
values for the leading term.
The third (<code class="docutils literal notranslate"><span class="pre">#3</span></code>) tells <code class="docutils literal notranslate"><span class="pre">fitter.lsqfit</span></code> to fit parameters from
only the first <code class="docutils literal notranslate"><span class="pre">N</span></code> terms in the fit function; parts of the prior that are
not being fit are incorporated (<em>marginalized</em>) into the fit data.
The last modification (<code class="docutils literal notranslate"><span class="pre">#4</span></code>) changes what is printed out.
The output
shows that
results for the leading term have converged by <code class="docutils literal notranslate"><span class="pre">N=2</span></code> (and even <code class="docutils literal notranslate"><span class="pre">N=1</span></code> is
pretty good):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.53</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1528.5</span>

<span class="n">Parameters</span><span class="p">:</span>
  <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">1.52158</span> <span class="p">(</span><span class="mi">87</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.87660</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.92</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
    <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">1.5380</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>    <span class="mf">0.18375</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.18</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>      <span class="o">-</span><span class="mf">2.56</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>      <span class="mf">0.382</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.41</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vnn</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>     <span class="mf">0.7664</span> <span class="p">(</span><span class="mi">59</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vno</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>     <span class="o">-</span><span class="mf">0.724</span> <span class="p">(</span><span class="mi">55</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">---------------------------------------------------</span>
       <span class="n">etas</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>    <span class="mf">0.21837</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
      <span class="n">etas</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">0.41620</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.40</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
         <span class="n">Ds</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>    <span class="mf">0.21481</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Ds</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">1.20171</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.20</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Dso</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>      <span class="mf">0.077</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">Dso</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>      <span class="mf">1.465</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.50</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">35</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">9</span><span class="o">/</span><span class="mf">0.0</span><span class="p">)</span>

<span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1586.4</span>

<span class="n">Parameters</span><span class="p">:</span>
  <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">1.52174</span> <span class="p">(</span><span class="mi">76</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">1.68</span> <span class="p">(</span><span class="mi">54</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.87665</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.92</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">0.51</span> <span class="p">(</span><span class="mi">18</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
    <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>    <span class="o">-</span><span class="mf">1.5388</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">1.34</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>    <span class="mf">0.18368</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.18</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.707</span> <span class="p">(</span><span class="mi">56</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>      <span class="o">-</span><span class="mf">2.72</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">2.43</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>     <span class="mf">0.3688</span> <span class="p">(</span><span class="mi">85</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.41</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">1.41</span> <span class="p">(</span><span class="mi">34</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vnn</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>    <span class="mf">0.76702</span> <span class="p">(</span><span class="mi">94</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>     <span class="o">-</span><span class="mf">0.471</span> <span class="p">(</span><span class="mi">54</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>      <span class="mf">0.072</span> <span class="p">(</span><span class="mi">65</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>       <span class="mf">0.04</span> <span class="p">(</span><span class="mi">96</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vno</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>     <span class="o">-</span><span class="mf">0.785</span> <span class="p">(</span><span class="mi">59</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>       <span class="mf">0.33</span> <span class="p">(</span><span class="mi">22</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>       <span class="mf">0.40</span> <span class="p">(</span><span class="mi">49</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>       <span class="mf">0.13</span> <span class="p">(</span><span class="mi">98</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">---------------------------------------------------</span>
       <span class="n">etas</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>    <span class="mf">0.21833</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>       <span class="mf">0.19</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
      <span class="n">etas</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">0.41618</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.40</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>       <span class="mf">0.60</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
         <span class="n">Ds</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>    <span class="mf">0.21463</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.262</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Ds</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">1.20163</span> <span class="p">(</span><span class="mi">18</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.20</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.493</span> <span class="p">(</span><span class="mi">28</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Dso</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>     <span class="mf">0.0661</span> <span class="p">(</span><span class="mi">67</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.088</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">Dso</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>      <span class="mf">1.446</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.50</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.244</span> <span class="p">(</span><span class="mi">84</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">24</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">20</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">Fit</span> <span class="n">results</span><span class="p">:</span>
  <span class="n">Eetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">1.02</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
  <span class="n">aetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21833</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="mf">0.19</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

  <span class="n">EDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.20163</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="mf">1.695</span><span class="p">(</span><span class="mi">28</span><span class="p">)]</span>
  <span class="n">aDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21463</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="mf">0.262</span><span class="p">(</span><span class="mi">31</span><span class="p">)]</span>

  <span class="n">EDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.446</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">1.690</span><span class="p">(</span><span class="mi">89</span><span class="p">)]</span>
  <span class="n">aDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0661</span><span class="p">(</span><span class="mi">67</span><span class="p">)</span> <span class="mf">0.088</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>

  <span class="n">etas</span><span class="o">-&gt;</span><span class="n">V</span><span class="o">-&gt;</span><span class="n">Ds</span>  <span class="o">=</span> <span class="mf">0.76702</span><span class="p">(</span><span class="mi">94</span><span class="p">)</span>

<span class="n">Values</span><span class="p">:</span>
              <span class="n">metas</span><span class="p">:</span> <span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>         
                <span class="n">mDs</span><span class="p">:</span> <span class="mf">1.20163</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>         
                <span class="n">Vnn</span><span class="p">:</span> <span class="mf">0.76702</span><span class="p">(</span><span class="mi">94</span><span class="p">)</span>         

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                  <span class="n">metas</span>       <span class="n">mDs</span>       <span class="n">Vnn</span>
<span class="o">-------------------------------------------</span>
  <span class="n">statistics</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.09</span>
         <span class="n">svd</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.05</span>
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
<span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
 <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
         <span class="n">Vnn</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.06</span>
         <span class="n">Vno</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
<span class="o">-------------------------------------------</span>
       <span class="n">total</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.12</span>
</pre></div>
</div>
<p>The tests applied to the first fit can be used here as well. For example,
setting <code class="docutils literal notranslate"><span class="pre">noise=True</span></code> in the
fit results in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================</span> <span class="n">add</span> <span class="n">svd</span><span class="p">,</span> <span class="n">prior</span> <span class="n">noise</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.37</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1569.9</span>

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">8e-05</span><span class="o">/</span><span class="mi">24</span><span class="o">*</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">18</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span>

      <span class="n">fit</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;etas:a&#39;</span><span class="p">:</span> <span class="mf">0.21833</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">:</span> <span class="mf">0.41618</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">:</span> <span class="mf">0.21463</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">:</span> <span class="mf">1.20163</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="s1">&#39;Vnn&#39;</span><span class="p">:</span> <span class="mf">0.76702</span><span class="p">(</span><span class="mi">94</span><span class="p">)}</span>
<span class="n">noisy</span> <span class="n">fit</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;etas:a&#39;</span><span class="p">:</span> <span class="mf">0.21834</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;etas:dE&#39;</span><span class="p">:</span> <span class="mf">0.41617</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Ds:a&#39;</span><span class="p">:</span> <span class="mf">0.21470</span><span class="p">(</span><span class="mi">23</span><span class="p">),</span><span class="s1">&#39;Ds:dE&#39;</span><span class="p">:</span> <span class="mf">1.20166</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;Vnn&#39;</span><span class="p">:</span> <span class="mf">0.76743</span><span class="p">(</span><span class="mi">88</span><span class="p">)}</span>
           <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="o">=</span> <span class="mf">0.74</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.6</span>
</pre></div>
</div>
<p>This suggests a good fit. The results are consistent with the original
fit.</p>
</div>
<div class="section" id="variation-chained-fit">
<h2>Variation: Chained Fit<a class="headerlink" href="#variation-chained-fit" title="Permalink to this headline">¶</a></h2>
<p>Chained fits are used if <code class="docutils literal notranslate"><span class="pre">fitter.lsqfit(...)</span></code>
is replaced by <code class="docutils literal notranslate"><span class="pre">fitter.chained_lsqfit(...)</span></code> in <code class="docutils literal notranslate"><span class="pre">main()</span></code>. Following
the advice at the end of <a class="reference internal" href="faster.html#chained-fits"><span class="std std-ref">Chained Fits</span></a>, we combine chained
fits with marginalization. Three parts of our original code need
modifications:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="s1">&#39;etas-Ds.h5&#39;</span><span class="p">)</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">make_models</span><span class="p">()</span>                                              <span class="c1"># 1a</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">models</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>                                             <span class="c1"># 1b</span>
      <span class="nb">dict</span><span class="p">(</span><span class="n">nterm</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">svdcut</span><span class="o">=</span><span class="mf">6.3e-5</span><span class="p">),</span>                                <span class="c1"># 1c</span>
      <span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">models</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>                                            <span class="c1"># 1d</span>
      <span class="p">]</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">CorrFitter</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">models</span><span class="p">)</span>                               <span class="c1"># 1e</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;nterm =&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">chained_lsqfit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">)</span>      <span class="c1"># 2</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstyle</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="s1">&#39;m&#39;</span><span class="p">))</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">pmean</span>
    <span class="n">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISPLAYPLOTS</span><span class="p">:</span>
        <span class="n">fit</span><span class="o">.</span><span class="n">show_plots</span><span class="p">()</span>
</pre></div>
</div>
<p>The first modification (<code class="docutils literal notranslate"><span class="pre">#1</span></code>) replaces the original list of models with
a structured list that instructs the (chained) fitter sequentially to:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>fit the <code class="docutils literal notranslate"><span class="pre">etas</span></code> 2-point correlator described in <code class="docutils literal notranslate"><span class="pre">models[0]</span></code> (<code class="docutils literal notranslate"><span class="pre">#1b</span></code>);</p></li>
<li><p>fit the <code class="docutils literal notranslate"><span class="pre">Ds</span></code> 2-point correlator described in <code class="docutils literal notranslate"><span class="pre">models[1]</span></code>  (<code class="docutils literal notranslate"><span class="pre">#1b</span></code>);</p></li>
<li><p>reset fit parameters <code class="docutils literal notranslate"><span class="pre">nterm=(2,</span> <span class="pre">1)</span></code> (marginalize all but the
first three states) and <code class="docutils literal notranslate"><span class="pre">svdcut=6.3e-5</span></code> for
subsequent fits (<code class="docutils literal notranslate"><span class="pre">#1c</span></code>);</p></li>
<li><p>fit simultaneously the two 3-point correlators described
in <code class="docutils literal notranslate"><span class="pre">(models[2],models[3])</span></code>  (<code class="docutils literal notranslate"><span class="pre">#1d</span></code>).</p></li>
</ol>
</div></blockquote>
<p>The second modification (<code class="docutils literal notranslate"><span class="pre">#2</span></code>) replaces <code class="docutils literal notranslate"><span class="pre">lsqfit</span></code> by <code class="docutils literal notranslate"><span class="pre">chained_lsqfit</span></code>.
It also removes the SVD cutfrom the 2-point fits;
as discussed above (<code class="docutils literal notranslate"><span class="pre">1c</span></code>), the SVD cut is reintroduced for the 3-point
fits.</p>
<p>The output for <code class="docutils literal notranslate"><span class="pre">N=4</span></code> terms is substantially shorter than for our
original code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.68</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.98</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1599.9</span>

<span class="n">Parameters</span><span class="p">:</span>
  <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">1.52143</span> <span class="p">(</span><span class="mi">76</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">1.62</span> <span class="p">(</span><span class="mi">35</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">1.22</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">1.28</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">0.87656</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.92</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">0.47</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">0.78</span> <span class="p">(</span><span class="mi">74</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.65</span> <span class="p">(</span><span class="mi">98</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
    <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>   <span class="o">-</span><span class="mf">1.53910</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">1.38</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">0.81</span> <span class="p">(</span><span class="mi">53</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">1.12</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>    <span class="mf">0.18366</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.18</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>     <span class="o">-</span><span class="mf">0.732</span> <span class="p">(</span><span class="mi">56</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">0.67</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>      <span class="o">-</span><span class="mf">0.76</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
   <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>     <span class="o">-</span><span class="mf">2.670</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">2.07</span> <span class="p">(</span><span class="mi">56</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">2.24</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>     <span class="mf">0.3698</span> <span class="p">(</span><span class="mi">51</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.41</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="o">-</span><span class="mf">0.73</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>      <span class="o">-</span><span class="mf">0.75</span> <span class="p">(</span><span class="mi">98</span><span class="p">)</span>      <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vnn</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>     <span class="mf">0.7675</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>     <span class="o">-</span><span class="mf">0.439</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>      <span class="mf">0.063</span> <span class="p">(</span><span class="mi">53</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>    <span class="o">-</span><span class="mf">0.006</span> <span class="p">(</span><span class="mi">873</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vno</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>     <span class="o">-</span><span class="mf">0.711</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>      <span class="o">-</span><span class="mf">0.26</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.0</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">---------------------------------------------------</span>
       <span class="n">etas</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>    <span class="mf">0.21840</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.198</span> <span class="p">(</span><span class="mi">70</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>       <span class="mf">0.30</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.28</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
      <span class="n">etas</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">0.41621</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.40</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.625</span> <span class="p">(</span><span class="mi">78</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>       <span class="mf">0.46</span> <span class="p">(</span><span class="mi">34</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.52</span> <span class="p">(</span><span class="mi">51</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
         <span class="n">Ds</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>    <span class="mf">0.21457</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.252</span> <span class="p">(</span><span class="mi">33</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>       <span class="mf">0.45</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.33</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Ds</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>    <span class="mf">1.20161</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.20</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.481</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>       <span class="mf">0.51</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>       <span class="mf">0.47</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Dso</span><span class="p">:</span><span class="n">a</span> <span class="mi">0</span>     <span class="mf">0.0693</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>      <span class="mf">0.127</span> <span class="p">(</span><span class="mi">71</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>       <span class="mf">0.11</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
       <span class="n">Dso</span><span class="p">:</span><span class="n">dE</span> <span class="mi">0</span>     <span class="mf">1.4474</span> <span class="p">(</span><span class="mi">74</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">1.50</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>       <span class="mf">0.48</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>       <span class="mf">0.47</span> <span class="p">(</span><span class="mi">46</span><span class="p">)</span>      <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">6.3e-05</span><span class="o">/</span><span class="mi">3</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">34</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">fitter</span> <span class="o">=</span> <span class="n">chained</span> <span class="n">fit</span>    

<span class="n">Chained</span> <span class="n">Fits</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span>       <span class="n">Q</span>     <span class="n">logGBF</span>  <span class="n">svd</span><span class="o">-</span><span class="n">n</span>    <span class="n">itns</span><span class="o">/</span><span class="n">time</span>  <span class="n">fit</span>            
<span class="o">------------------------------------------------------------------------</span>
       <span class="mf">0.69</span> <span class="p">[</span><span class="mi">28</span><span class="p">]</span>    <span class="mf">0.88</span>     <span class="mf">488.06</span>      <span class="mi">0</span>       <span class="mi">12</span><span class="o">/</span><span class="mf">0.0</span>  <span class="n">etas</span>
       <span class="mf">0.75</span> <span class="p">[</span><span class="mi">28</span><span class="p">]</span>    <span class="mf">0.83</span>     <span class="mf">850.45</span>      <span class="mi">0</span>       <span class="mi">16</span><span class="o">/</span><span class="mf">0.0</span>  <span class="n">Ds</span>
       <span class="mf">0.52</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span>    <span class="mf">0.91</span>     <span class="mf">261.41</span>      <span class="mi">3</span>        <span class="mi">6</span><span class="o">/</span><span class="mf">0.0</span>  <span class="p">(</span><span class="mi">3</span><span class="n">ptT15</span><span class="p">,</span><span class="mi">3</span><span class="n">ptT16</span><span class="p">)</span>
<span class="o">------------------------------------------------------------------------</span>
       <span class="mf">0.68</span> <span class="p">[</span><span class="mi">69</span><span class="p">]</span>    <span class="mf">0.98</span>     <span class="mf">1599.9</span>      <span class="mi">3</span>       <span class="mi">34</span><span class="o">/</span><span class="mf">0.1</span>  <span class="nb">all</span>

<span class="n">Fit</span> <span class="n">results</span><span class="p">:</span>
  <span class="n">Eetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.41621</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="mf">1.042</span><span class="p">(</span><span class="mi">78</span><span class="p">)</span> <span class="mf">1.50</span><span class="p">(</span><span class="mi">40</span><span class="p">)]</span>
  <span class="n">aetas</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21840</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="mf">0.198</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span> <span class="mf">0.30</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>

  <span class="n">EDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.20161</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="mf">1.682</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="mf">2.19</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span>
  <span class="n">aDs</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.21457</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="mf">0.252</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="mf">0.45</span><span class="p">(</span><span class="mi">24</span><span class="p">)]</span>

  <span class="n">EDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.4474</span><span class="p">(</span><span class="mi">74</span><span class="p">)</span> <span class="mf">1.93</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="mf">2.40</span><span class="p">(</span><span class="mi">54</span><span class="p">)]</span>
  <span class="n">aDso</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0693</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="mf">0.127</span><span class="p">(</span><span class="mi">71</span><span class="p">)</span> <span class="mf">0.11</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

  <span class="n">etas</span><span class="o">-&gt;</span><span class="n">V</span><span class="o">-&gt;</span><span class="n">Ds</span>  <span class="o">=</span> <span class="mf">0.7675</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="n">Values</span><span class="p">:</span>
              <span class="n">metas</span><span class="p">:</span> <span class="mf">0.41621</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>         
                <span class="n">mDs</span><span class="p">:</span> <span class="mf">1.20161</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>         
                <span class="n">Vnn</span><span class="p">:</span> <span class="mf">0.7675</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>          

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                  <span class="n">metas</span>       <span class="n">mDs</span>       <span class="n">Vnn</span>
<span class="o">-------------------------------------------</span>
  <span class="n">statistics</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.12</span>
         <span class="n">svd</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.02</span>
 <span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
<span class="n">log</span><span class="p">(</span><span class="n">etas</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
   <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Ds</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>
  <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">a</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
 <span class="n">log</span><span class="p">(</span><span class="n">Dso</span><span class="p">:</span><span class="n">dE</span><span class="p">):</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
         <span class="n">Vnn</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.05</span>
         <span class="n">Vno</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">0.01</span>
<span class="o">-------------------------------------------</span>
       <span class="n">total</span><span class="p">:</span>      <span class="mf">0.03</span>      <span class="mf">0.01</span>      <span class="mf">0.14</span>
</pre></div>
</div>
<p>Again the results agree well with the original fit.
Fit results are listed from each step in the chain: first just
the <code class="docutils literal notranslate"><span class="pre">etas</span></code> 2-point correlator, then the <code class="docutils literal notranslate"><span class="pre">Ds</span></code> 2-point
correlator, and finally a combined fit of both 3-point
correlators. One might try less marginalization (e.g.,
<code class="docutils literal notranslate"><span class="pre">nterm=(1,1)</span></code>) to check that results are stable. Also one might
test the fits, as above.</p>
<p>Chained fits are particularly useful for very large data sets
(much larger than this one). Also marginalizing extraneous variables in the
3-point fits can make fitting more robust (because it is simpler).</p>
</div>
<div class="section" id="mixing">
<h2>Mixing<a class="headerlink" href="#mixing" title="Permalink to this headline">¶</a></h2>
<p>Code to analyze <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/>-<img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> mixing is very similar to the code above for
a transition form factor. The <code class="docutils literal notranslate"><span class="pre">main()</span></code> and <code class="docutils literal notranslate"><span class="pre">make_data()</span></code> functions are
identical, except that here data are read from file <code class="docutils literal notranslate"><span class="pre">'Ds-Ds.h5'</span></code> and
the appropriate SVD cut is <code class="docutils literal notranslate"><span class="pre">svdcut=0.003</span></code> (see <a class="reference internal" href="faster.html#svd-cuts"><span class="std std-ref">Accurate Fits — SVD Cuts</span></a>).
We need models for the two-point <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> correlator, and for two three-point
correlators describing the <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> to <img class="math" src="_images/math/516b34b50bd893feebe0aa136f82e521322cb385.svg" alt="D_s"/> transition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_models</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Create models to fit data. &quot;&quot;&quot;</span>
    <span class="n">tmin</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">cf</span><span class="o">.</span><span class="n">Corr2</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;Ds&#39;</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="n">tp</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
            <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ao&#39;</span><span class="p">),</span> <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ao&#39;</span><span class="p">),</span> <span class="n">dE</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dEo&#39;</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="n">cf</span><span class="o">.</span><span class="n">Corr3</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;DsDsT18&#39;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
            <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ao&#39;</span><span class="p">),</span> <span class="n">dEa</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dEo&#39;</span><span class="p">),</span> <span class="n">sa</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ao&#39;</span><span class="p">),</span> <span class="n">dEb</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dEo&#39;</span><span class="p">),</span> <span class="n">sb</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span>
            <span class="n">Vnn</span><span class="o">=</span><span class="s1">&#39;Vnn&#39;</span><span class="p">,</span> <span class="n">Voo</span><span class="o">=</span><span class="s1">&#39;Voo&#39;</span><span class="p">,</span> <span class="n">Vno</span><span class="o">=</span><span class="s1">&#39;Vno&#39;</span><span class="p">,</span> <span class="n">symmetric_V</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="n">cf</span><span class="o">.</span><span class="n">Corr3</span><span class="p">(</span>
            <span class="n">datatag</span><span class="o">=</span><span class="s1">&#39;DsDsT15&#39;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
            <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ao&#39;</span><span class="p">),</span> <span class="n">dEa</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dEo&#39;</span><span class="p">),</span> <span class="n">sa</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ao&#39;</span><span class="p">),</span> <span class="n">dEb</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dE&#39;</span><span class="p">,</span> <span class="s1">&#39;dEo&#39;</span><span class="p">),</span> <span class="n">sb</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span>
            <span class="n">Vnn</span><span class="o">=</span><span class="s1">&#39;Vnn&#39;</span><span class="p">,</span> <span class="n">Voo</span><span class="o">=</span><span class="s1">&#39;Voo&#39;</span><span class="p">,</span> <span class="n">Vno</span><span class="o">=</span><span class="s1">&#39;Vno&#39;</span><span class="p">,</span> <span class="n">symmetric_V</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">models</span>
</pre></div>
</div>
<p>The initial and final states in the three-point correlators are the same
here so we set parameter <code class="docutils literal notranslate"><span class="pre">symmetricV=True</span></code> in <a class="reference internal" href="corrfitter.html#corrfitter.Corr3" title="corrfitter.Corr3"><code class="xref py py-class docutils literal notranslate"><span class="pre">corrfitter.Corr3</span></code></a>.</p>
<p>The prior is also similar to the previous case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_prior</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create priors for fit parameters. &quot;&quot;&quot;</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">BufferDict</span><span class="p">()</span>
    <span class="c1"># Ds</span>
    <span class="n">mDs</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="s1">&#39;1.2(2)&#39;</span><span class="p">)</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(a)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.3(3)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(dE)&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.5(5)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(dE)&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mDs</span><span class="p">)</span>

    <span class="c1"># Ds -- oscillating part</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(ao)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.1(1)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(dEo)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.5(5)&#39;</span><span class="p">]))</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;log(dEo)&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mDs</span> <span class="o">+</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="s1">&#39;0.3(3)&#39;</span><span class="p">))</span>

    <span class="c1"># V</span>
    <span class="n">nV</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">nV</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.0(5)&#39;</span><span class="p">])</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Voo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">nV</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.0(5)&#39;</span><span class="p">])</span>
    <span class="n">prior</span><span class="p">[</span><span class="s1">&#39;Vno&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;0.0(5)&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">prior</span>
</pre></div>
</div>
<p>We use log-normal distributions for the energy differences, and
amplitudes.
We store only the upper triangular parts of the <code class="docutils literal notranslate"><span class="pre">Vnn</span></code> and <code class="docutils literal notranslate"><span class="pre">Voo</span></code> matrices
since they are symmetrical (because <code class="docutils literal notranslate"><span class="pre">symmetricV=True</span></code> is set).</p>
<p>A minimal <code class="docutils literal notranslate"><span class="pre">print_results()</span></code> function is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Print results of fit. &quot;&quot;&quot;</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;mDs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;dE&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;statistics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>             <span class="c1"># statistical errors in data</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;Ds priors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span><span class="n">prior</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;log(a)&#39;</span><span class="p">,</span> <span class="s1">&#39;log(dE)&#39;</span><span class="p">,</span> <span class="s1">&#39;log(ao)&#39;</span><span class="p">,</span> <span class="s1">&#39;log(dEo)&#39;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;V priors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span><span class="n">prior</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Vnn&#39;</span><span class="p">,</span> <span class="s1">&#39;Vno&#39;</span><span class="p">,</span> <span class="s1">&#39;Voo&#39;</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">gv</span><span class="o">.</span><span class="n">fmt_values</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">fmt_errorbudget</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">inputs</span><span class="p">))</span>
</pre></div>
</div>
<p>Running the mixing code gives the following output for <code class="docutils literal notranslate"><span class="pre">N=4</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================</span> <span class="n">nterm</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Least</span> <span class="n">Square</span> <span class="n">Fit</span><span class="p">:</span>
  <span class="n">chi2</span><span class="o">/</span><span class="n">dof</span> <span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.68</span> <span class="p">[</span><span class="mi">53</span><span class="p">]</span>    <span class="n">Q</span> <span class="o">=</span> <span class="mf">0.96</span>    <span class="n">logGBF</span> <span class="o">=</span> <span class="mf">1559.9</span>

<span class="n">Parameters</span><span class="p">:</span>
       <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="mi">0</span>      <span class="o">-</span><span class="mf">1.5555</span> <span class="p">(</span><span class="mi">58</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">1.64</span> <span class="p">(</span><span class="mi">35</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.74</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">1.40</span> <span class="p">(</span><span class="mi">91</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">1.2</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
      <span class="n">log</span><span class="p">(</span><span class="n">dE</span><span class="p">)</span> <span class="mi">0</span>      <span class="mf">0.27128</span> <span class="p">(</span><span class="mi">55</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.18</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">0.93</span> <span class="p">(</span><span class="mi">22</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.87</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.83</span> <span class="p">(</span><span class="mi">99</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
      <span class="n">log</span><span class="p">(</span><span class="n">ao</span><span class="p">)</span> <span class="mi">0</span>        <span class="o">-</span><span class="mf">2.76</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">2.14</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">2.60</span> <span class="p">(</span><span class="mi">76</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">2.47</span> <span class="p">(</span><span class="mi">97</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">2.3</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
     <span class="n">log</span><span class="p">(</span><span class="n">dEo</span><span class="p">)</span> <span class="mi">0</span>        <span class="mf">0.341</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.41</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="o">-</span><span class="mf">1.27</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.65</span> <span class="p">(</span><span class="mi">92</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.57</span> <span class="p">(</span><span class="mi">98</span><span class="p">)</span>       <span class="p">[</span> <span class="o">-</span><span class="mf">0.7</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">]</span>  
          <span class="n">Vnn</span> <span class="mi">0</span>       <span class="mf">0.1065</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>       <span class="o">-</span><span class="mf">0.005</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="mf">0.001</span> <span class="p">(</span><span class="mi">85</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.15</span> <span class="p">(</span><span class="mi">37</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>       <span class="mf">0.004</span> <span class="p">(</span><span class="mi">500</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>     <span class="mf">0.0005</span> <span class="p">(</span><span class="mi">4993</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>       <span class="mf">0.002</span> <span class="p">(</span><span class="mi">500</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">7</span>   <span class="mf">0.00006</span> <span class="p">(</span><span class="mi">50000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">8</span>      <span class="mf">3e-06</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">9</span>      <span class="mf">2e-08</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
        <span class="n">Vno</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>      <span class="o">-</span><span class="mf">0.2104</span> <span class="p">(</span><span class="mi">91</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>       <span class="o">-</span><span class="mf">0.006</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">2</span>         <span class="mf">0.06</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">0</span><span class="p">,</span><span class="mi">3</span>        <span class="o">-</span><span class="mf">0.03</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>        <span class="mf">0.016</span> <span class="p">(</span><span class="mi">89</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>    <span class="o">-</span><span class="mf">0.0003</span> <span class="p">(</span><span class="mi">4998</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>     <span class="o">-</span><span class="mf">3e-05</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>     <span class="mf">0.0002</span> <span class="p">(</span><span class="mi">5000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">0</span>         <span class="mf">0.03</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>       <span class="mf">0.002</span> <span class="p">(</span><span class="mi">500</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>      <span class="mf">2e-07</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">2</span><span class="p">,</span><span class="mi">3</span>      <span class="mf">1e-07</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">0</span>        <span class="o">-</span><span class="mf">0.04</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>    <span class="o">-</span><span class="mf">0.0005</span> <span class="p">(</span><span class="mi">5000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">2</span>      <span class="mf">2e-07</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
            <span class="mi">3</span><span class="p">,</span><span class="mi">3</span>     <span class="o">-</span><span class="mf">6e-10</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
          <span class="n">Voo</span> <span class="mi">0</span>       <span class="o">-</span><span class="mf">0.091</span> <span class="p">(</span><span class="mi">60</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>         <span class="mf">0.02</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="o">-</span><span class="mf">0.05</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="o">-</span><span class="mf">0.02</span> <span class="p">(</span><span class="mi">49</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.004</span> <span class="p">(</span><span class="mi">500</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">5</span>    <span class="o">-</span><span class="mf">0.0005</span> <span class="p">(</span><span class="mi">5000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">6</span>    <span class="o">-</span><span class="mf">0.0008</span> <span class="p">(</span><span class="mi">5000</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">7</span>     <span class="o">-</span><span class="mf">4e-07</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">8</span>     <span class="o">-</span><span class="mf">2e-07</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">9</span>     <span class="o">-</span><span class="mf">1e-10</span> <span class="o">+-</span> <span class="mf">0.5</span>       <span class="p">[</span>  <span class="mf">0.00</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
<span class="o">------------------------------------------------------</span>
            <span class="n">a</span> <span class="mi">0</span>       <span class="mf">0.2111</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.194</span> <span class="p">(</span><span class="mi">67</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="mf">0.477</span> <span class="p">(</span><span class="mi">75</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.25</span> <span class="p">(</span><span class="mi">22</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.30</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">]</span>  
           <span class="n">dE</span> <span class="mi">0</span>      <span class="mf">1.31164</span> <span class="p">(</span><span class="mi">72</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">1.20</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.395</span> <span class="p">(</span><span class="mi">86</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="mf">0.419</span> <span class="p">(</span><span class="mi">64</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.44</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
           <span class="n">ao</span> <span class="mi">0</span>       <span class="mf">0.0633</span> <span class="p">(</span><span class="mi">79</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.118</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>        <span class="mf">0.074</span> <span class="p">(</span><span class="mi">56</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>        <span class="mf">0.085</span> <span class="p">(</span><span class="mi">82</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.10</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>  
          <span class="n">dEo</span> <span class="mi">0</span>        <span class="mf">1.407</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">1.50</span> <span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">1</span>        <span class="mf">0.282</span> <span class="p">(</span><span class="mi">55</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">2</span>         <span class="mf">0.52</span> <span class="p">(</span><span class="mi">48</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  
              <span class="mi">3</span>         <span class="mf">0.56</span> <span class="p">(</span><span class="mi">55</span><span class="p">)</span>       <span class="p">[</span>  <span class="mf">0.50</span> <span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">]</span>  

<span class="n">Settings</span><span class="p">:</span>
  <span class="n">svdcut</span><span class="o">/</span><span class="n">n</span> <span class="o">=</span> <span class="mf">0.002</span><span class="o">/</span><span class="mi">9</span>    <span class="n">tol</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-08</span><span class="o">*</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">)</span>    <span class="p">(</span><span class="n">itns</span><span class="o">/</span><span class="n">time</span> <span class="o">=</span> <span class="mi">81</span><span class="o">/</span><span class="mf">0.4</span><span class="p">)</span>


<span class="n">Values</span><span class="p">:</span>
                <span class="n">mDs</span><span class="p">:</span> <span class="mf">1.31164</span><span class="p">(</span><span class="mi">72</span><span class="p">)</span>         
                <span class="n">Vnn</span><span class="p">:</span> <span class="mf">0.1065</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>          

<span class="n">Partial</span> <span class="o">%</span> <span class="n">Errors</span><span class="p">:</span>
                  <span class="n">mDs</span>       <span class="n">Vnn</span>
<span class="o">-------------------------------</span>
<span class="n">statistics</span><span class="p">:</span>      <span class="mf">0.05</span>      <span class="mf">1.16</span>
 <span class="n">Ds</span> <span class="n">priors</span><span class="p">:</span>      <span class="mf">0.02</span>      <span class="mf">0.51</span>
  <span class="n">V</span> <span class="n">priors</span><span class="p">:</span>      <span class="mf">0.00</span>      <span class="mf">1.37</span>
<span class="o">-------------------------------</span>
     <span class="n">total</span><span class="p">:</span>      <span class="mf">0.06</span>      <span class="mf">1.88</span>
</pre></div>
</div>
<p>The fits for individual correlators look good:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 35%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><img alt="_images/Ds-Ds.Ds.png" src="_images/Ds-Ds.Ds.png" />
</td>
<td><img alt="_images/Ds-Ds.DsDsT15.png" src="_images/Ds-Ds.DsDsT15.png" />
</td>
<td><img alt="_images/Ds-Ds.DsDsT18.png" src="_images/Ds-Ds.DsDsT18.png" />
</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Annotated Example: Transition Form Factor and Mixing</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#code">Code</a><ul>
<li><a class="reference internal" href="#a-make-data">a) make_data</a></li>
<li><a class="reference internal" href="#b-make-models">b) make_models</a></li>
<li><a class="reference internal" href="#c-make-prior">c) make_prior</a></li>
<li><a class="reference internal" href="#d-print-results">d) print_results</a></li>
<li><a class="reference internal" href="#e-svd-cut">e) SVD Cut</a></li>
</ul>
</li>
<li><a class="reference internal" href="#results">Results</a></li>
<li><a class="reference internal" href="#testing-the-fit">Testing the Fit</a></li>
<li><a class="reference internal" href="#variation-marginalization">Variation: Marginalization</a></li>
<li><a class="reference internal" href="#variation-chained-fit">Variation: Chained Fit</a></li>
<li><a class="reference internal" href="#mixing">Mixing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="example-etas.html"
                        title="previous chapter">Annotated Example: Two-Point Correlator</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="example-etab.html"
                        title="next chapter">Annotated Example: Matrix Correlator</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/example-etas-Ds.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example-etab.html" title="Annotated Example: Matrix Correlator"
             >next</a> |</li>
        <li class="right" >
          <a href="example-etas.html" title="Annotated Example: Two-Point Correlator"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">corrfitter 8.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-21, G.P. Lepage.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>